import{R,bh as M,a7 as H,bi as G,bj as K,bk as J,bl as W,ad as X,a9 as Y,aS as Z,T as ee,aT as te,ae as se,af as ae,bm as oe,bn as le,bo as ne,bp as ie,bq as re,ah as ue,U as de,b as t,d as D,r as b,y as ce,C as N,o as j,a as S,c as z,w as l,j as F,B as me,m as $,e as r,b9 as U,i as L,t as B,q,h as P,b8 as A,N as pe,V as fe,f as E,g as h,k as T,Q as ve,n as _e,p as be,s as ye,O as ge,H as I,u as O,v as Q,x as xe,F as Ve,_ as ke}from"./index-MoPcLG9q.js";import{V as Ce}from"./VForm-DLbA7YId.js";import{_ as he}from"./FileInput.vue_vue_type_script_setup_true_lang-4mwtK9wc.js";import{u as qe}from"./course-CL_v0EK1.js";import{q as we}from"./VDataTable-BW5uJkcr.js";import"./VTable-DrOtf772.js";const $e=R({color:String,...M(),...H(),...G(),...K(),...J(),...W(),...X(),...Y(),...Z()},"VSheet"),Se=ee()({name:"VSheet",props:$e(),setup(n,k){let{slots:p}=k;const{themeClasses:v}=te(n),{backgroundColorClasses:x,backgroundColorStyles:_}=se(ae(n,"color")),{borderClasses:i}=oe(n),{dimensionStyles:d}=le(n),{elevationClasses:y}=ne(n),{locationStyles:o}=ie(n),{positionClasses:V}=re(n),{roundedClasses:f}=ue(n);return de(()=>t(n.tag,{class:["v-sheet",v.value,x.value,i.value,y.value,V.value,f.value,n.class],style:[_.value,d.value,o.value,n.style]},p)),{}}}),Fe=r("h2",{class:"text-primary mb-5 text-left"},"Add new question?",-1),Pe=r("h3",{class:"text-primary text-left mb-2"},"General information",-1),Ue={class:"d-flex flex-row justify-space-between"},Ie=r("h3",{class:"text-primary text-left mb-2"},"Others",-1),Be={class:"d-flex flex-row justify-space-between mt-1"},Ee={class:"mt-3 d-flex flex-row justify-end"},Te=D({__name:"AddQuestionForm",props:{numOfLab:{type:Number,default:0},classCode:{type:String,default:""}},emits:["openQuestionForm"],setup(n,{emit:k}){const p=k,v=n,x=[{title:"Easy",value:1},{title:"Medium",value:2},{title:"Hard",value:3}],_=b(!1),i=b(),d=b(),y=b(),o=ce({question:{description:"",lab:"",topic:"",level:void 0,question_id:"",question_code:"",url:""}});function V(){const m=Array.from({length:v.numOfLab},(e,C)=>C+1).map(e=>e);let s=[];return m.forEach(e=>{s.push(`${e}-pre`),s.push(`${e}-in`),s.push(`${e}-post`)}),s}function f(m){return m==="Hard"?"red":m==="Medium"?"orange":"green"}function g(m,s){return(""+m.code).localeCompare(s.code)}function u(m){return!!m||"Field is required"}async function c(){const m=v.classCode.substring(6,12);await P.get(`/api/courses/${m}/outcomes`).then(function(s){const{data:e}=s;y.value=e.map(C=>({pk:C.pk,code:C.outcome_code})).sort(g)})}const a=N("create-notification");async function w(){_.value=!0,setTimeout(async()=>{await P.post(`/api/classes/${v.classCode}/labs/${i.value}/exercises/`,{exercise_id:o.question.question_id,exercise_code:o.question.question_code,exercise_name:o.question.description,class_code:v.classCode,level:o.question.level,topic:o.question.topic,outcome:d.value,url:o.question.url}).then(function(m){_.value=!1,a({type:"success",message:"Create question successfully!"}),p("openQuestionForm",!1)}).catch(()=>{_.value=!1,a({type:"error",message:"Failed to create new question!"}),p("openQuestionForm",!1)})},1e3)}return j(()=>{c()}),(m,s)=>(S(),z(Se,{class:"mx-auto w-50 pa-5 text-right"},{default:l(()=>[Fe,t(F,{class:"mb-4"}),t(Ce,{"validate-on":"submit lazy",onSubmit:me(w,["prevent"])},{default:l(()=>[Pe,t($,{label:"Question name",density:"comfortable",variant:"outlined",class:"mt-1",rules:[u],modelValue:o.question.description,"onUpdate:modelValue":s[0]||(s[0]=e=>o.question.description=e)},null,8,["rules","modelValue"]),r("div",Ue,[t($,{label:"Question code",density:"comfortable",variant:"outlined",class:"w-25 mr-4",rules:[u],modelValue:o.question.question_code,"onUpdate:modelValue":s[1]||(s[1]=e=>o.question.question_code=e)},null,8,["rules","modelValue"]),t($,{label:"Question id",density:"comfortable",variant:"outlined",class:"w-25 mr-4",rules:[u],modelValue:o.question.question_id,"onUpdate:modelValue":s[2]||(s[2]=e=>o.question.question_id=e)},null,8,["rules","modelValue"]),t(U,{label:"Level",items:x,modelValue:o.question.level,"onUpdate:modelValue":s[3]||(s[3]=e=>o.question.level=e),variant:"outlined",density:"comfortable",rules:[u],style:{width:"100px"}},{selection:l(({item:e,index:C})=>[t(L,{color:f(e.title)},{default:l(()=>[r("span",null,B(e.title),1)]),_:2},1032,["color"])]),_:1},8,["modelValue","rules"])]),t(F,{class:"my-2"}),Ie,r("div",Be,[t($,{label:"Topic",density:"comfortable",variant:"outlined",class:"w-25 mr-4",rules:[u],modelValue:o.question.topic,"onUpdate:modelValue":s[4]||(s[4]=e=>o.question.topic=e)},null,8,["rules","modelValue"]),t(U,{label:"Lab",items:V(),modelValue:i.value,"onUpdate:modelValue":s[5]||(s[5]=e=>i.value=e),variant:"outlined",density:"comfortable",rules:[u],class:"w-25 mr-4"},null,8,["items","modelValue","rules"]),t(U,{label:"Outcome",items:y.value,"item-title":"code","item-value":"pk",modelValue:d.value,"onUpdate:modelValue":s[6]||(s[6]=e=>d.value=e),variant:"outlined",density:"comfortable",rules:[u],style:{width:"100px"}},null,8,["items","modelValue","rules"])]),t($,{label:"BKel Link",density:"comfortable",variant:"outlined",class:"mt-1",rules:[u],modelValue:o.question.url,"onUpdate:modelValue":s[7]||(s[7]=e=>o.question.url=e)},null,8,["rules","modelValue"]),t(F),r("div",Ee,[t(q,{text:"Close",class:"text-none bg-grey-lighten-3 mr-3",flat:"",onClick:s[8]||(s[8]=e=>p("openQuestionForm",!1)),disabled:_.value},null,8,["disabled"]),t(q,{class:"text-none bg-light-blue",text:"Submit",type:"submit",flat:"",loading:_.value},null,8,["loading"])])]),_:1})]),_:1}))}}),De={class:"d-flex flex-row text-primary mb-2"},Le=r("h2",{class:"my-auto"},"Import new file",-1),Oe=r("p",{class:"mt-4"},"Please import more question data for the student ",-1),Qe={class:"border-sm rounded pa-4 my-4 mx-auto",style:{height:"250px"}},Ne={class:"d-flex flex-row text-primary"},je=r("h3",null,"Exercise file",-1),ze={key:0,class:"mt-15"},Ae={key:1,class:"text-center mt-10"},Re=D({__name:"ImportCard",props:{classId:{type:Number,required:!0}},emits:["openImportCard"],setup(n,{emit:k}){const p=k,v=n,x=A(),_=pe(),i=b(),d=b(!1),y=N("create-notification"),o="http://127.0.0.1:8000";async function V(){if(i.value){const f=new FormData;f.append("exercise_file",i.value),f.append("class_code",`${v.classId}`),console.log("FormData ",f),d.value=!0,await ge.post(`${o}/api/classes/${x.params.class_code}/exercises/upload`,f,{headers:{Authorization:`Bearer ${_.token}`,"Content-Type":"multipart/form-data"}}).then(function(g){var u;d.value=!1,p("openImportCard",!1),y({type:"success",message:`Uploaded file ${(u=i.value)==null?void 0:u.name} successfully!`})}).catch(function(){d.value=!1,p("openImportCard",!1),y({type:"error",message:"Something's wrong when uploading!"})})}}return(f,g)=>{const u=he;return S(),z(ye,{class:"w-66 mx-auto text-secondary"},{default:l(()=>[t(fe,null,{default:l(()=>[r("div",De,[Le,t(E,{size:"md",class:"ml-2 my-auto"},{default:l(()=>[h("fas fa-chevron-right")]),_:1}),t(L,{class:"ml-4 my-auto"},{default:l(()=>[h("Exercises")]),_:1})]),t(F),Oe,r("div",Qe,[r("div",Ne,[t(E,{class:"mr-2"},{default:l(()=>[h("fas fa-file-alt")]),_:1}),je]),d.value?(S(),T("div",Ae,[t(ve,{size:100,width:7,color:"primary",indeterminate:""})])):(S(),T("div",ze,[t(u,{idx:0,type:"Exercise",onUploadFile:g[0]||(g[0]=c=>i.value=c)})]))])]),_:1}),t(F,{class:"my-1"}),t(_e,null,{default:l(()=>[t(be),t(q,{text:"Close",class:"text-none bg-blue-lighten-5 text-blue-darken-2",onClick:g[1]||(g[1]=c=>p("openImportCard",!1)),disabled:d.value},null,8,["disabled"]),t(q,{class:"text-none bg-primary",text:"Save",onClick:V,disabled:d.value},null,8,["disabled"])]),_:1})]),_:1})}}}),Me={class:"d-flex flex-row w-100 justify-space-between"},He={class:"text-primary"},Ze=D({__name:"Exercise",setup(n){const k=A(),p=b(!1),v=b(!1),x=b(0),_=b(0),i=k.params.class_code.toString(),d=qe();async function y(){const c=i.substring(6,12),{data:a}=await P.get(`/api/courses/${c}/classes/${i}`);x.value=a.pk,_.value=a.num_of_lab}function o(c){window.open(c,"_blank")}const V=b();async function f(){const{data:c}=await P.get(`/api/classes/${i}/exercises`);V.value=c.map(a=>{const w=a.level===1?"1-easy":a.level===2?"2-medium":a.level===3?"3-hard":"";return{question:a.exercise_code,name:a.exercise_name,level:w,topic:a.topic,lab_id:a.lab,outcome_id:a.outcome,bkel_link:a.url}})}j(async()=>{await y(),await f()});function g(c){return c==="3-hard"?"red":c==="2-medium"?"orange":"green"}const u=[{title:"question",align:"start",key:"question",sortable:!1},{title:"name",align:"start",key:"name",sortable:!1},{title:"level",align:"start",key:"level",sortable:!1},{title:"topic",align:"start",key:"topic",sortable:!1},{title:"lab_id",align:"start",key:"lab_id",sortable:!1},{title:"outcome_id",align:"start",key:"outcome_id",sortable:!1},{title:"bkel_link",align:"center",key:"bkel_link",sortable:!1}];return(c,a)=>{const w=ke,m=Re,s=Te;return S(),T(Ve,null,[t(w),t(xe,null,{default:l(()=>[r("div",Me,[r("h1",He," ["+B(I(i).substring(6))+"] Exercises ",1),r("div",null,[t(O,{modelValue:p.value,"onUpdate:modelValue":a[2]||(a[2]=e=>p.value=e)},{activator:l(({props:e})=>[t(q,Q({onClick:a[0]||(a[0]=C=>I(d).resetCourse()),variant:"outlined"},e,{class:"text-none text-primary mr-3","prepend-icon":"fas fa-file-upload"}),{default:l(()=>[h("Import")]),_:2},1040)]),default:l(()=>[t(m,{classId:x.value,onOpenImportCard:a[1]||(a[1]=e=>{p.value=e,f()})},null,8,["classId"])]),_:1},8,["modelValue"]),t(O,{modelValue:v.value,"onUpdate:modelValue":a[4]||(a[4]=e=>v.value=e)},{activator:l(({props:e})=>[t(q,Q({variant:"flat",height:"40"},e,{class:"text-none bg-primary text-white","prepend-icon":"fas fa-plus"}),{default:l(()=>[h("New question")]),_:2},1040)]),default:l(()=>[t(s,{numOfLab:_.value,classCode:I(i),onOpenQuestionForm:a[3]||(a[3]=e=>{v.value=e,f()})},null,8,["numOfLab","classCode"])]),_:1},8,["modelValue"])])]),t(we,{class:"border-sm rounded-lg mt-8",items:V.value,headers:u,"item-value":"name","show-select":""},{"item.level":l(({value:e})=>[t(L,{color:g(e)},{default:l(()=>[h(B(e),1)]),_:2},1032,["color"])]),"item.bkel_link":l(({value:e})=>[t(q,{icon:"",variant:"plain",onClick:C=>o(e)},{default:l(()=>[t(E,{size:"xsmall",class:"text-dark-grey"},{default:l(()=>[h("fas fa-link")]),_:1})]),_:2},1032,["onClick"])]),_:1},8,["items"])]),_:1})],64)}}});export{Ze as default};
