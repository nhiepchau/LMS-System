import{d as w,N as y,r as l,a as v,c as I,w as d,b as r,M as k,c1 as B,B as $,m as V,q as N,g as S,k as C,P as L,j as T,s as U,x as q,e as c,h as b,c2 as A}from"./index-Cc2wFGp6.js";import{V as E}from"./VForm-BOHvNMSk.js";const F=c("h1",{class:"text-center my-10"},"Learning Outcome Evaluation Support",-1),z=c("br",null,null,-1),H={key:0,class:"text-error text-sm-center mt-4"},M=c("p",{class:"text-center"},[S("If you're student, please activate account before login at "),c("a",{href:"/register/"},"Activate page")],-1),O=w({__name:"Login",setup(P){const m=y(),n=l(!1),u=l(""),i=l(""),o=l(!1),p=l(!0);async function x(){n.value&&(o.value=!0,setTimeout(async()=>{const s=u.value.toString(),t=i.value.toString();await b.post("/api/users/login/",{username:u.value,password:i.value}).then(function(a){o.value=!1,b.interceptors.request.use(g=>(g.headers.Authorization=`Bearer ${a.data.access}`,g)),m.setLogin(s,t,a.data.access);const e=a.data.user,h=e.is_teacher?`${e.first_name} ${e.last_name}`:`${f(e.first_name)} ${f(e.last_name)}`;m.setUserInfo(h,e.is_teacher?e.is_head_teacher?"Head Lecturer":"Teacher":"Student",e.email,e.is_teacher?"":e.student_id),sessionStorage.setItem("username",s),sessionStorage.setItem("password",t),sessionStorage.setItem("token",a.data.access),sessionStorage.setItem("fullname",h),sessionStorage.setItem("role",e.is_teacher?e.is_head_teacher?"Head Lecturer":"Teacher":"Student"),sessionStorage.setItem("email",e.email),sessionStorage.setItem("studentId",e.is_teacher?"":e.student_id),A.push({name:"homepage"})}).catch(()=>{p.value=!1,o.value=!1})},1e3))}function f(s){const t=`${s}`.at(0),a=`${s}`.length;return t+"x".repeat(a-1)}function _(s){return!!s||"Field is required"}return(s,t)=>(v(),I(q,{class:"bg-grey-lighten-4 h-100",fluid:""},{default:d(()=>[F,r(U,{class:"mx-auto px-6 py-8","max-width":"400"},{default:d(()=>[r(k,{src:B,width:"8rem",class:"mb-8 mx-auto"}),r(E,{modelValue:n.value,"onUpdate:modelValue":t[2]||(t[2]=a=>n.value=a),onSubmit:$(x,["prevent"])},{default:d(()=>[r(V,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=a=>u.value=a),readonly:o.value,rules:[_],class:"mb-2",label:"Username",clearable:""},null,8,["modelValue","readonly","rules"]),r(V,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=a=>i.value=a),readonly:o.value,rules:[_],label:"Password",placeholder:"Enter your password",clearable:"",type:"password"},null,8,["modelValue","readonly","rules"]),z,r(N,{disabled:!n.value,loading:o.value,color:"info",size:"large",type:"submit",variant:"elevated",block:""},{default:d(()=>[S(" Sign In ")]),_:1},8,["disabled","loading"]),p.value?L("",!0):(v(),C("p",H,"Incorrect username or password!")),r(T,{class:"mt-8 mb-2"}),M]),_:1},8,["modelValue"])]),_:1})]),_:1}))}});export{O as default};
