import{d as S,N as w,r as l,a as h,c as x,w as d,b as s,M as y,bZ as I,B as k,m as v,q as B,g as V,k as C,P as L,j as N,s as T,x as U,e as c,h as g,b_ as $}from"./index-MoPcLG9q.js";import{V as q}from"./VForm-DLbA7YId.js";const A=c("h1",{class:"text-center my-10"},"Learning Outcome Evaluation Support",-1),E=c("br",null,null,-1),F={key:0,class:"text-error text-sm-center mt-4"},z=c("p",{class:"text-center"},[V("If you're student, please activate account before login at "),c("a",{href:"/register/"},"Activate page")],-1),j=S({__name:"Login",setup(H){const m=w(),n=l(!1),u=l(""),i=l(""),r=l(!1),p=l(!0);async function b(){n.value&&(r.value=!0,setTimeout(async()=>{const o=u.value.toString(),t=i.value.toString();await g.post("/api/users/login/",{username:u.value,password:i.value}).then(function(a){r.value=!1,g.interceptors.request.use(f=>(f.headers.Authorization=`Bearer ${a.data.access}`,f)),m.setLogin(o,t,a.data.access);const e=a.data.user;m.setUserInfo(`${e.first_name} ${e.last_name}`,e.is_teacher?e.is_head_teacher?"Head Lecturer":"Teacher":"Student",e.email,e.is_teacher?"":e.student_id),sessionStorage.setItem("username",o),sessionStorage.setItem("password",t),sessionStorage.setItem("token",a.data.access),sessionStorage.setItem("fullname",`${e.first_name} ${e.last_name}`),sessionStorage.setItem("role",e.is_teacher?e.is_head_teacher?"Head Lecturer":"Teacher":"Student"),sessionStorage.setItem("email",e.email),sessionStorage.setItem("studentId",e.is_teacher?"":e.student_id),$.push({name:"homepage"})}).catch(()=>{p.value=!1,r.value=!1})},1e3))}function _(o){return!!o||"Field is required"}return(o,t)=>(h(),x(U,{class:"bg-grey-lighten-4 h-100",fluid:""},{default:d(()=>[A,s(T,{class:"mx-auto px-6 py-8","max-width":"400"},{default:d(()=>[s(y,{src:I,width:"8rem",class:"mb-8 mx-auto"}),s(q,{modelValue:n.value,"onUpdate:modelValue":t[2]||(t[2]=a=>n.value=a),onSubmit:k(b,["prevent"])},{default:d(()=>[s(v,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=a=>u.value=a),readonly:r.value,rules:[_],class:"mb-2",label:"Username",clearable:""},null,8,["modelValue","readonly","rules"]),s(v,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=a=>i.value=a),readonly:r.value,rules:[_],label:"Password",placeholder:"Enter your password",clearable:"",type:"password"},null,8,["modelValue","readonly","rules"]),E,s(B,{disabled:!n.value,loading:r.value,color:"info",size:"large",type:"submit",variant:"elevated",block:""},{default:d(()=>[V(" Sign In ")]),_:1},8,["disabled","loading"]),p.value?L("",!0):(h(),C("p",F,"Incorrect username or password!")),s(N,{class:"mt-8 mb-2"}),z]),_:1},8,["modelValue"])]),_:1})]),_:1}))}});export{j as default};
