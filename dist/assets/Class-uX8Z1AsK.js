import{d as V,b4 as B,b5 as O,b6 as L,b7 as N,b8 as I,r as y,I as P,X as j,o as D,a as E,c as S,k as a,b as s,b9 as R,u as g,ba as T,w as u,g as f,i as x,t as _,G as z,bb as W,bc as G,bd as H,be as U,A as k,bf as K,v as M,x as $,s as X,F as q,H as J,C as Q}from"./index-DnKygW34.js";import{h as C}from"./http-nrUfQssp.js";const Y={class:"d-flex flex-row justify-space-between"},Z=a("h3",{class:"my-auto w-50"},"Pass/Fail rates",-1),tt={class:"mt-2 w-50 mx-auto"},st={class:"d-flex flex-row mt-3 text-sub-chart justify-center"},et={class:"ml-2 my-auto"},at={class:"mt-2"},ot={class:"d-flex flex-row"},nt={class:"my-auto text-lg-body-2"},lt={class:"d-flex flex-row mt-1"},ct={class:"my-auto text-lg-body-2"},rt={class:"d-flex flex-row mt-1"},ut={class:"my-auto text-lg-body-2"},it={class:"d-flex flex-row mt-1"},dt={class:"my-auto text-lg-body-2"},mt=V({__name:"DoughnutChart",setup(F){B.register(O,L,N);const i=I().params.class_code,h=i.toString().substring(6,12),l=y(""),p=y(),o=P({chartData:{labels:["Pass","Fail"],datasets:[{backgroundColor:["#6F9CEB","#F3F4F6"],data:[0,0],cutout:40}]},outcomeInfo:{threshold:0,rates:0,labs:[]}}),v=j(()=>o.chartData);function b(e,c){return(""+e.outcome_code).localeCompare(c.outcome_code)}async function d(){await C.get(`/api/courses/${h}/outcomes`).then(function(e){var r,t;const{data:c}=e;p.value=c.map(w=>({pk:w.pk,outcome_code:w.outcome_code,parent_outcome:w.parent_outcome,threshold:w.threshold})).sort(b),l.value||(l.value=((t=(r=p.value)==null?void 0:r.at(0))==null?void 0:t.outcome_code)??"",m(l.value))})}async function m(e){await C.get(`/api/classes/${i}/outcomes/${e}/progress`).then(function(c){const{data:r}=c;o.chartData={labels:["Pass","Fail"],datasets:[{backgroundColor:["#6F9CEB","#F3F4F6"],data:[r.passed,r.failed],cutout:40}]},o.outcomeInfo={threshold:r.threshold,rates:r.rate*100,labs:r.labs.map(t=>({lab:t.lab,contribution:t.contribution}))},console.log("State ",o.outcomeInfo)})}D(()=>{d()});const n={responsive:!0,maintainAspectRatio:!0};return(e,c)=>{var r;return E(),S("div",z({class:"px-4 pt-2 pb-6 border-sm rounded-lg h-100"},e.$attrs),[a("div",Y,[Z,s(R,{label:"Group by:",modelValue:l.value,"onUpdate:modelValue":[c[0]||(c[0]=t=>l.value=t),c[1]||(c[1]=t=>m(t))],items:(r=p.value)==null?void 0:r.map(t=>t.outcome_code),variant:"solo",density:"compact",class:"mt-3","bg-color":"#F3F4F6",flat:""},null,8,["modelValue","items"])]),a("div",tt,[s(g(T),{options:n,data:v.value},null,8,["data"])]),a("div",st,[s(x,{size:"large",class:"my-auto"},{default:u(()=>[f("fas fa-location-arrow")]),_:1}),a("h2",et,_(o.outcomeInfo.rates)+"%",1)]),a("div",at,[a("div",ot,[s(x,{class:"my-auto mr-3",color:"#4EA699",size:"small"},{default:u(()=>[f("fas fa-check")]),_:1}),a("p",nt,"Threshold: "+_(o.outcomeInfo.threshold)+" points.",1)]),a("div",lt,[s(x,{class:"mr-3",color:"#4EA699",size:"small"},{default:u(()=>[f("fas fa-check")]),_:1}),a("p",ct,"Contribution from labs: "+_(o.outcomeInfo.labs.map(t=>`${t.lab} (${t.contribution})`).join(", "))+".",1)]),a("div",rt,[s(x,{class:"my-auto mr-3",color:"#4EA699",size:"small"},{default:u(()=>[f("fas fa-check")]),_:1}),a("p",ut,_(o.outcomeInfo.rates)+"% students passed "+_(l.value)+".",1)]),a("div",it,[s(x,{class:"my-auto mr-3",color:"#DE3B40",size:"small"},{default:u(()=>[f("fas fa-times")]),_:1}),a("p",dt,_(100-o.outcomeInfo.rates)+"% students failed "+_(l.value)+".",1)])])],16)}}}),_t={class:"d-flex flex-row justify-space-between w-100"},ft=a("h3",{class:"mt-2"},"Outcome Progress Overview",-1),pt={class:"d-flex flex-row w-33"},bt=V({__name:"OverviewChart",props:{num_of_lab:{type:Number,default:4}},setup(F){B.register(W,O,L,G,H,U);const i=I().params.class_code,h=F,l=y();function p(){const m=Array.from({length:h.num_of_lab},(e,c)=>c+1).map(e=>e);let n=[];return m.forEach(e=>{n.push(`${e}-pre`),n.push(`${e}-in`),n.push(`${e}-post`)}),l.value||(l.value=`${h.num_of_lab}-post`),n}const o=P({chartData:{labels:[],datasets:[{label:"",backgroundColor:"",data:[],barThickness:0,borderWidth:0}]}}),v=j(()=>(console.log("Redraw chart!!!"),o.chartData));async function b(m){console.log("Retest chart!!!"),await C.get(`/api/classes/${i}/labs/${m}/overview`).then(function(n){const{data:e}=n;o.chartData={labels:e.outcomes,datasets:[{label:"Passed",backgroundColor:"#4EA699",data:e.passed??[],barThickness:25,borderWidth:1},{label:"Failed",backgroundColor:"#4F4F4F",data:e.failed??[],barThickness:25,borderWidth:1}]}})}D(()=>{b(l.value??"")});const d={responsive:!0,maintainAspectRatio:!0};return(m,n)=>(E(),S("div",z({class:"pa-4 border-sm rounded-lg"},m.$attrs),[a("div",_t,[ft,a("div",pt,[s(R,{label:"Lab",modelValue:l.value,"onUpdate:modelValue":[n[0]||(n[0]=e=>l.value=e),n[1]||(n[1]=e=>b(e))],items:p(),variant:"solo",density:"compact",class:"mr-2","bg-color":"#F3F4F6",flat:""},null,8,["modelValue","items"]),s(k,{height:"40",flat:"",class:"text-none text-blue-lighten-2 bg-blue-lighten-5"},{default:u(()=>[f("View all")]),_:1})])]),a("div",null,[s(g(K),{id:"my-chart-id",options:d,data:v.value},null,8,["data"])])],16))}}),ht={class:"d-flex flex-row w-100 justify-space-between"},gt={class:"text-dark-grey"},vt={class:"text-primary"},xt={class:"d-flex flex-row w-100"},$t=V({__name:"Class",setup(F){const i=I().params.class_code,h=i.toString().substring(2,5),l=i.toString().substring(6).substring(0,6),p=y(""),o=y();async function v(){await C.get(`/api/courses/${l}/classes/${i}`).then(function(b){const{data:d}=b;o.value={num_of_lab:d.num_of_lab,num_of_exercises:d.num_of_exercises,num_of_submissions:d.num_of_submissions,num_of_outcomes:d.num_of_outcomes,num_of_students:d.num_of_students},p.value=`${d.course}`.substring(7)})}return D(()=>{v()}),(b,d)=>{const m=J,n=Q,e=bt,c=mt;return E(),S(q,null,[s(m),s(X,null,{default:u(()=>{var r;return[a("div",ht,[a("h1",gt,[a("span",vt,"[HK"+_(g(h))+"] "+_(g(i).toString().substring(13)),1),f(" - "+_(p.value),1)]),a("div",null,[s(k,{to:`/class/${g(i)}/exercise`,variant:"outlined",width:"145",class:"text-none pl-0 text-primary mr-3 justify-space-between","append-icon":"fas fa-plus"},{default:u(()=>[f(" Exercise ")]),_:1},8,["to"]),s(k,{to:`/class/${g(i)}/submission`,variant:"flat",class:"text-none bg-primary text-white","append-icon":"fas fa-chevron-right"},{default:u(()=>[f(" Submission ")]),_:1},8,["to"])])]),s(M,{class:"mt-5"},{default:u(()=>[s($,null,{default:u(()=>{var t;return[s(n,{class:"bg-blue-lighten-4 text-blue-darken-4",info:(t=o.value)==null?void 0:t.num_of_submissions,typeInfo:"SubmissionsLarge"},null,8,["info"])]}),_:1}),s($,null,{default:u(()=>{var t;return[s(n,{class:"bg-green-lighten-5 text-dark-green",info:(t=o.value)==null?void 0:t.num_of_exercises,typeInfo:"ExercisesLarge"},null,8,["info"])]}),_:1}),s($,null,{default:u(()=>{var t;return[s(n,{class:"bg-grey-lighten-3 text-dark-grey",info:(t=o.value)==null?void 0:t.num_of_students,typeInfo:"StudentsLarge"},null,8,["info"])]}),_:1}),s($,null,{default:u(()=>{var t;return[s(n,{class:"bg-orange-lighten-4 text-orange-darken-3",info:(t=o.value)==null?void 0:t.num_of_outcomes,typeInfo:"OutcomesLarge"},null,8,["info"])]}),_:1})]),_:1}),a("div",xt,[s(e,{num_of_lab:(r=o.value)==null?void 0:r.num_of_lab,class:"w-66 mt-7 mr-4"},null,8,["num_of_lab"]),s(c,{percent:80,class:"w-33 mt-7"})])]}),_:1})],64)}}});export{$t as default};
