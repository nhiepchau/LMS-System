import{m as te,a as ae,b as se,c as oe,d as le,e as ne,f as re,u as ie,p as ue,g as de,h as me,i as ce,j as pe,k as ge,l as ve,n as R,o as $,q as F,_ as be}from"./VDataTable-AIUxmdsv.js";import{K as _e,M as fe,I as D,a8 as m,aP as ye,ab as Pe,N as he,g as s,F as j,E as P,d as Se,r as g,G as we,o as Ve,e as Te,w as y,b as k,t as De,J as ke,z as xe,j as Ie,s as Be,a_ as Ce,H as Ee}from"./index-2v8kRtHD.js";import{h as q}from"./http-UipYOg7Q.js";import{V as Ge}from"./VDialog-DTO3Qq-H.js";import{V as H}from"./VTable-B6NYblOx.js";import"./FileInput.vue_vue_type_script_setup_true_lang-D1FWhtmc.js";const Ne=_e({itemsLength:{type:[Number,String],required:!0},...te(),...ae(),...se()},"VDataTableServer"),Re=fe()({name:"VDataTableServer",props:Ne(),emits:{"update:modelValue":t=>!0,"update:page":t=>!0,"update:itemsPerPage":t=>!0,"update:sortBy":t=>!0,"update:options":t=>!0,"update:expanded":t=>!0,"update:groupBy":t=>!0},setup(t,h){let{attrs:v,slots:e}=h;const{groupBy:r}=oe(t),{sortBy:i,multiSort:b,mustSort:S}=le(t),{page:d,itemsPerPage:c}=ne(t),w=D(()=>parseInt(t.itemsLength,10)),{columns:_,headers:V}=re(t,{groupBy:r,showSelect:m(t,"showSelect"),showExpand:m(t,"showExpand")}),{items:o}=ie(t,_),{toggleSort:a}=ue({sortBy:i,multiSort:b,mustSort:S,page:d}),{opened:p,isGroupOpen:l,toggleGroup:u,extractRows:L}=de({groupBy:r,sortBy:i}),{pageCount:O,setItemsPerPage:U}=me({page:d,itemsPerPage:c,itemsLength:w}),{flatItems:x}=ce(o,r,p),{isSelected:M,select:z,selectAll:A,toggleSelect:J,someSelected:K,allSelected:W}=pe(t,{allItems:o,currentPage:o}),{isExpanded:Q,toggleExpand:X}=ge(t),I=D(()=>L(o.value));ve({page:d,itemsPerPage:c,sortBy:i,groupBy:r,search:m(t,"search")}),ye("v-data-table",{toggleSort:a,sortBy:i}),Pe({VDataTableRows:{hideNoData:m(t,"hideNoData"),noDataText:m(t,"noDataText"),loading:m(t,"loading"),loadingText:m(t,"loadingText")}});const n=D(()=>({page:d.value,itemsPerPage:c.value,sortBy:i.value,pageCount:O.value,toggleSort:a,setItemsPerPage:U,someSelected:K.value,allSelected:W.value,isSelected:M,select:z,selectAll:A,toggleSelect:J,isExpanded:Q,toggleExpand:X,isGroupOpen:l,toggleGroup:u,items:I.value.map(T=>T.raw),internalItems:I.value,groupedItems:x.value,columns:_.value,headers:V.value}));he(()=>{const T=R.filterProps(t),Y=$.filterProps(t),Z=F.filterProps(t),ee=H.filterProps(t);return s(H,P({class:["v-data-table",{"v-data-table--loading":t.loading},t.class],style:t.style},ee),{top:()=>{var f;return(f=e.top)==null?void 0:f.call(e,n.value)},default:()=>{var f,B,C,E,G,N;return e.default?e.default(n.value):s(j,null,[(f=e.colgroup)==null?void 0:f.call(e,n.value),s("thead",{class:"v-data-table__thead",role:"rowgroup"},[s($,P(Y,{sticky:t.fixedHeader}),e)]),(B=e.thead)==null?void 0:B.call(e,n.value),s("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[(C=e["body.prepend"])==null?void 0:C.call(e,n.value),e.body?e.body(n.value):s(F,P(v,Z,{items:x.value}),e),(E=e["body.append"])==null?void 0:E.call(e,n.value)]),(G=e.tbody)==null?void 0:G.call(e,n.value),(N=e.tfoot)==null?void 0:N.call(e,n.value)])},bottom:()=>e.bottom?e.bottom(n.value):s(R,T,{prepend:e["footer.prepend"]})})})}}),$e={class:"d-flex flex-row w-100 justify-space-between"},Fe={class:"text-primary"},Me=Se({__name:"Submission",setup(t){const h=Ce(),v=g(!1),e=g(0),r=h.params.class_code.toString(),i=g(25),b=g(!1);async function S(){const o=r.substring(6,12),{data:a}=await q.get(`/api/courses/${o}/classes/${r}`);e.value=a.pk,d.value=a.num_of_submissions}const d=g(0),c=g();async function w({page:o,itemsPerPage:a,sortBy:p}){b.value=!0,await _(o,a),b.value=!1}async function _(o,a){const{data:p}=await q.get(`/api/classes/${r}/submissions?page=${o}&items=${a}`);c.value=p.map(l=>({question_id:l.exercise,secured_student_id:l.student,started_time:l.started_time,submitted_time:l.submitted_time,time_taken:l.time_taken,score:l.score}))}we(async()=>{await S(),await _(1,i.value)});const V=[{title:"question_id",align:"start",key:"question_id",sortable:!1},{title:"secured_student_id",align:"start",key:"secured_student_id",sortable:!1},{title:"started_time",align:"start",key:"started_time",sortable:!1},{title:"submitted_time",align:"start",key:"submitted_time",sortable:!1},{title:"time_taken",align:"start",key:"time_taken",sortable:!1},{title:"score",align:"center",key:"score",sortable:!1}];return(o,a)=>{const p=Ee,l=be;return Ve(),Te(j,null,[s(p),s(Be,null,{default:y(()=>[k("div",$e,[k("h1",Fe," ["+De(ke(r).substring(6))+"] Submissions ",1),k("div",null,[s(Ge,{modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=u=>v.value=u)},{activator:y(({props:u})=>[s(xe,P({variant:"flat"},u,{class:"text-none bg-primary text-white","prepend-icon":"fas fa-file-upload"}),{default:y(()=>[Ie("Import")]),_:2},1040)]),default:y(()=>[s(l,{classId:e.value,onOpenImportCard:a[0]||(a[0]=u=>{v.value=u})},null,8,["classId"])]),_:1},8,["modelValue"])])]),s(Re,{class:"border-sm rounded-lg mt-8","items-per-page":i.value,"onUpdate:itemsPerPage":a[2]||(a[2]=u=>i.value=u),items:c.value,headers:V,"items-length":d.value,loading:b.value,"item-value":"name","show-select":"","onUpdate:options":w},null,8,["items-per-page","items","items-length","loading"])]),_:1})],64)}}});export{Me as default};
