import{d as V,b3 as B,b4 as O,b5 as A,b6 as N,b7 as D,r as y,I as j,Y as L,o as P,a as I,c as E,l as a,b as s,b8 as R,u as g,b9 as T,w as u,g as f,j as x,t as _,G as z,h as C,ba as U,bb as W,bc as G,bd as H,be as K,B as k,bf as M,x as Y,y as $,v as q,F as J,H as Q,_ as X}from"./index-BFMTCsx2.js";const Z={class:"d-flex flex-row justify-space-between"},tt=a("h3",{class:"my-auto w-50"},"Pass/Fail rates",-1),st={class:"mt-2 w-50 mx-auto"},et={class:"d-flex flex-row mt-3 text-sub-chart justify-center"},at={class:"ml-2 my-auto"},ot={class:"mt-2"},nt={class:"d-flex flex-row"},lt={class:"my-auto text-lg-body-2"},ct={class:"d-flex flex-row mt-1"},rt={class:"my-auto text-lg-body-2"},ut={class:"d-flex flex-row mt-1"},it={class:"my-auto text-lg-body-2"},dt={class:"d-flex flex-row mt-1"},mt={class:"my-auto text-lg-body-2"},_t=V({__name:"DoughnutChart",setup(F){B.register(O,A,N);const i=D().params.class_code,p=i.toString().substring(6,12),l=y(""),b=y(),o=j({chartData:{labels:["Pass","Fail"],datasets:[{backgroundColor:["#6F9CEB","#F3F4F6"],data:[0,0],cutout:40}]},outcomeInfo:{threshold:0,rates:0,labs:[]}}),v=L(()=>o.chartData);function h(e,c){return(""+e.outcome_code).localeCompare(c.outcome_code)}async function d(){await C.get(`/api/courses/${p}/outcomes`).then(function(e){var r,t;const{data:c}=e;b.value=c.map(w=>({pk:w.pk,outcome_code:w.outcome_code,parent_outcome:w.parent_outcome,threshold:w.threshold})).sort(h),l.value||(l.value=((t=(r=b.value)==null?void 0:r.at(0))==null?void 0:t.outcome_code)??"",m(l.value))})}async function m(e){await C.get(`/api/classes/${i}/outcomes/${e}/progress`).then(function(c){const{data:r}=c;o.chartData={labels:["Pass","Fail"],datasets:[{backgroundColor:["#6F9CEB","#F3F4F6"],data:[r.passed,r.failed],cutout:40}]},o.outcomeInfo={threshold:r.threshold,rates:r.rate*100,labs:r.labs.map(t=>({lab:t.lab,contribution:t.contribution}))}})}P(()=>{d()});const n={responsive:!0,maintainAspectRatio:!0};return(e,c)=>{var r;return I(),E("div",z({class:"px-4 pt-2 pb-6 border-sm rounded-lg h-100"},e.$attrs),[a("div",Z,[tt,s(R,{label:"Group by:",modelValue:l.value,"onUpdate:modelValue":[c[0]||(c[0]=t=>l.value=t),c[1]||(c[1]=t=>m(t))],items:(r=b.value)==null?void 0:r.map(t=>t.outcome_code),variant:"solo",density:"compact",class:"mt-3","bg-color":"#F3F4F6",flat:""},null,8,["modelValue","items"])]),a("div",st,[s(g(T),{options:n,data:v.value},null,8,["data"])]),a("div",et,[s(x,{size:"large",class:"my-auto"},{default:u(()=>[f("fas fa-location-arrow")]),_:1}),a("h2",at,_(o.outcomeInfo.rates)+"%",1)]),a("div",ot,[a("div",nt,[s(x,{class:"my-auto mr-3",color:"#4EA699",size:"small"},{default:u(()=>[f("fas fa-check")]),_:1}),a("p",lt,"Threshold: "+_(o.outcomeInfo.threshold)+" points.",1)]),a("div",ct,[s(x,{class:"mr-3",color:"#4EA699",size:"small"},{default:u(()=>[f("fas fa-check")]),_:1}),a("p",rt,"Contribution from labs: "+_(o.outcomeInfo.labs.map(t=>`${t.lab} (${t.contribution})`).join(", "))+".",1)]),a("div",ut,[s(x,{class:"my-auto mr-3",color:"#4EA699",size:"small"},{default:u(()=>[f("fas fa-check")]),_:1}),a("p",it,_(o.outcomeInfo.rates)+"% students passed "+_(l.value)+".",1)]),a("div",dt,[s(x,{class:"my-auto mr-3",color:"#DE3B40",size:"small"},{default:u(()=>[f("fas fa-times")]),_:1}),a("p",mt,_(100-o.outcomeInfo.rates)+"% students failed "+_(l.value)+".",1)])])],16)}}}),ft={class:"d-flex flex-row justify-space-between w-100"},bt=a("h3",{class:"mt-2"},"Outcome Progress Overview",-1),pt={class:"d-flex flex-row w-33"},ht=V({__name:"OverviewChart",props:{num_of_lab:{type:Number,default:0}},setup(F){B.register(U,O,A,W,G,H);const i=D().params.class_code,p=F,l=y();function b(){const m=Array.from({length:p.num_of_lab},(e,c)=>c+1).map(e=>e);let n=[];return m.forEach(e=>{n.push(`${e}-pre`),n.push(`${e}-in`),n.push(`${e}-post`)}),n}const o=j({chartData:{labels:[],datasets:[{label:"",backgroundColor:"",data:[],barThickness:0,borderWidth:0}]}}),v=L(()=>(console.log("Redraw chart!!!"),o.chartData));async function h(m){console.log("Retest chart!!!"),await C.get(`/api/classes/${i}/labs/${m}/overview`).then(function(n){const{data:e}=n;o.chartData={labels:e.outcomes,datasets:[{label:"Passed",backgroundColor:"#4EA699",data:e.passed??[],barThickness:25,borderWidth:1},{label:"Failed",backgroundColor:"#4F4F4F",data:e.failed??[],barThickness:25,borderWidth:1}]}})}const d={responsive:!0,maintainAspectRatio:!0};return K(()=>{!l.value&&p.num_of_lab>0&&(l.value=`${p.num_of_lab}-post`,h(l.value))}),(m,n)=>(I(),E("div",z({class:"pa-4 border-sm rounded-lg"},m.$attrs),[a("div",ft,[bt,a("div",pt,[s(R,{label:"Lab",modelValue:l.value,"onUpdate:modelValue":[n[0]||(n[0]=e=>l.value=e),n[1]||(n[1]=e=>h(e))],items:b(),variant:"solo",density:"compact",class:"mr-2","bg-color":"#F3F4F6",flat:""},null,8,["modelValue","items"]),s(k,{to:`/class/${g(i)}/outcome`,height:"40",flat:"",class:"text-none text-blue-lighten-2 bg-blue-lighten-5"},{default:u(()=>[f("View all")]),_:1},8,["to"])])]),a("div",null,[s(g(M),{id:"my-chart-id",options:d,data:v.value},null,8,["data"])])],16))}}),gt={class:"d-flex flex-row w-100 justify-space-between"},vt={class:"text-dark-grey"},xt={class:"text-primary"},yt={class:"d-flex flex-row w-100"},$t=V({__name:"Class",setup(F){const i=D().params.class_code,p=i.toString().substring(2,5),l=i.toString().substring(6).substring(0,6),b=y(""),o=y();async function v(){await C.get(`/api/courses/${l}/classes/${i}`).then(function(h){const{data:d}=h;o.value={num_of_lab:d.num_of_lab,num_of_exercises:d.num_of_exercises,num_of_submissions:d.num_of_submissions,num_of_outcomes:d.num_of_outcomes,num_of_students:d.num_of_students},b.value=`${d.course}`.substring(7)})}return P(()=>{v()}),(h,d)=>{const m=Q,n=X,e=ht,c=_t;return I(),E(J,null,[s(m),s(q,null,{default:u(()=>{var r;return[a("div",gt,[a("h1",vt,[a("span",xt,"[HK"+_(g(p))+"] "+_(g(i).toString().substring(13)),1),f(" - "+_(b.value),1)]),a("div",null,[s(k,{to:`/class/${g(i)}/exercise`,variant:"outlined",width:"145",class:"text-none pl-0 text-primary mr-3 justify-space-between","append-icon":"fas fa-plus"},{default:u(()=>[f(" Exercise ")]),_:1},8,["to"]),s(k,{to:`/class/${g(i)}/submission`,variant:"flat",class:"text-none bg-primary text-white","append-icon":"fas fa-chevron-right"},{default:u(()=>[f(" Submission ")]),_:1},8,["to"])])]),s(Y,{class:"mt-5"},{default:u(()=>[s($,null,{default:u(()=>{var t;return[s(n,{class:"bg-blue-lighten-4 text-blue-darken-4",info:(t=o.value)==null?void 0:t.num_of_submissions,typeInfo:"SubmissionsLarge"},null,8,["info"])]}),_:1}),s($,null,{default:u(()=>{var t;return[s(n,{class:"bg-green-lighten-5 text-dark-green",info:(t=o.value)==null?void 0:t.num_of_exercises,typeInfo:"ExercisesLarge"},null,8,["info"])]}),_:1}),s($,null,{default:u(()=>{var t;return[s(n,{class:"bg-grey-lighten-3 text-dark-grey",info:(t=o.value)==null?void 0:t.num_of_students,typeInfo:"StudentsLarge"},null,8,["info"])]}),_:1}),s($,null,{default:u(()=>{var t;return[s(n,{class:"bg-orange-lighten-4 text-orange-darken-3",info:(t=o.value)==null?void 0:t.num_of_outcomes,typeInfo:"OutcomesLarge"},null,8,["info"])]}),_:1})]),_:1}),a("div",yt,[s(e,{num_of_lab:(r=o.value)==null?void 0:r.num_of_lab,class:"w-66 mt-7 mr-4"},null,8,["num_of_lab"]),s(c,{class:"w-33 mt-7"})])]}),_:1})],64)}}});export{$t as default};
