import{d as E,b3 as R,ba as I,b4 as q,b5 as H,bb as M,bc as Z,bd as z,r as _,y as G,u as L,aj as J,a as V,k as $,e as o,t as B,b as u,b8 as y,H as j,bf as A,j as K,F as N,l as Q,c as X,v as Y,h,c0 as ee,o as se,w as te,x as ae,_ as oe}from"./index-Cc2wFGp6.js";const le={class:"d-flex flex-row justify-space-between w-100"},ne={class:"w-66"},ce={class:"d-flex flex-row mt-2 mb-2"},ie={style:{width:"50%",height:"300px"}},re={class:"d-flex flex-row justify-space-between"},de={class:"w-33"},ue={class:"mt-2 font-italic font-weight-medium text-dark-brown"},me={style:{width:"50%",height:"300px"}},_e={class:"w-33 text-right"},pe={class:"w-100 mt-5"},fe=o("h3",null,"Suggested Exercises for Student",-1),be={class:"mt-3 d-flex flex-row justify-space-between"},ve={class:"w-25"},ge={class:"w-66"},he=E({__name:"CombineChart",props:{title:{type:String,default:"Statistics"},classCode:{type:String,default:""},numOfLab:{type:Number,default:0}},setup(D){R.register(I,q,H,M,Z,z);const i=_(),p=_(""),f=_(""),m=_(),v=_(),b=_(),t=D,r=G({averageProgress:0,chartData:{labels:[],datasets:[{label:"",backgroundColor:"",data:[],barThickness:0,borderWidth:0}]},secondChartData:{labels:[],datasets:[{label:"",backgroundColor:"",data:[],barThickness:0,borderWidth:0}]}}),g=L(()=>r.chartData),l=L(()=>r.secondChartData);async function k(n){await h.get(`/api/classes/${n}/students`).then(function(s){var d,c;const{data:a}=s;v.value=a.map(e=>({student_id:e.student_id,secured_student_id:e.secured_student_id,first_name:e.first_name,last_name:e.last_name})),i.value=((c=(d=v.value)==null?void 0:d.at(0))==null?void 0:c.student_id)??0,i.value&&(w(t.classCode,i.value),F(t.classCode,i.value))})}async function C(n){await h.get(`/api/classes/${n}/outcomes/${p.value}/histogram`).then(function(s){const{data:a}=s;r.chartData={labels:["0 - 0.2","0.2 - 0.4","0.4 - 0.6","0.6 - 0.8","0.8 - 1"],datasets:[{label:"Number of student",backgroundColor:"#4EA699",data:[a["0 - 0.2"],a["0.2 - 0.4"],a["0.4 - 0.6"],a["0.6 - 0.8"],a["0.8 - 1"]],barThickness:30,borderWidth:1}]},r.averageProgress=a.average})}async function w(n,s){const a=`${t.numOfLab}-post`;await h.get(`/api/classes/${n}/students/${s}/from/${a}/to/${a}/progress`).then(function(d){var O;const{data:c}=d,e=(O=m.value)==null?void 0:O.map(S=>c[S][0]*100),x=e==null?void 0:e.map(S=>100-S);r.secondChartData={labels:m.value??[],datasets:[{label:"Passed",backgroundColor:"#222E50",data:e??[],barThickness:20,borderWidth:1},{label:"Failed",backgroundColor:"#C8D6F9",data:x,barThickness:20,borderWidth:1}]}})}async function F(n,s){await h.get(`/api/classes/${n}/students/${s}/recommend`).then(function(a){const{data:d}=a;b.value=d.map(c=>({exercise_id:c.exercise_id,exercise_code:c.exercise_code,exercise_name:c.exercise_name,level:c.level}))})}function P(n,s){return(""+n).localeCompare(s)}async function T(n){const s=n.substring(6,12);await h.get(`/api/courses/${s}/outcomes`).then(function(a){var c,e;const{data:d}=a;m.value=d.map(x=>x.outcome_code).sort(P),p.value=((c=m.value)==null?void 0:c.at(0))??"",f.value=((e=m.value)==null?void 0:e.at(0))??"",p.value&&C(t.classCode)})}const U={responsive:!0,maintainAspectRatio:!1},W={responsive:!0,indexAxis:"x",maintainAspectRatio:!1,scales:{x:{stacked:!0},y:{stacked:!0,max:100,beginAtZero:!0,ticks:{callback:function(n,s,a){return n+"%"}}}}};return J(()=>t.classCode,()=>{C(t.classCode),k(t.classCode),T(t.classCode)}),(n,s)=>{var d,c;const a=ee;return V(),$("div",Y({class:"pa-4 border-sm rounded-lg"},n.$attrs),[o("div",le,[o("h3",ne,B(t.title),1)]),o("div",ce,[o("div",ie,[o("div",re,[o("div",de,[u(y,{label:"Outcome",modelValue:p.value,"onUpdate:modelValue":[s[0]||(s[0]=e=>p.value=e),s[1]||(s[1]=e=>{C(t.classCode)})],items:m.value,variant:"solo","bg-color":"#F3F4F6",flat:"",density:"compact"},null,8,["modelValue","items"])]),o("div",ue,"Average progress outcome: "+B(r.averageProgress*100)+"%",1)]),u(j(A),{id:"my-chart-id",options:U,data:g.value},null,8,["data"])]),u(K,{vertical:"",class:"mx-4",style:{height:"360px"}}),o("div",me,[o("div",_e,[u(y,{label:"Student ID",modelValue:i.value,"onUpdate:modelValue":[s[2]||(s[2]=e=>i.value=e),s[3]||(s[3]=e=>{w(t.classCode,e),F(t.classCode,e)})],items:(d=v.value)==null?void 0:d.map(e=>e.student_id),variant:"solo",density:"compact",class:"mr-2","bg-color":"#F3F4F6",flat:""},null,8,["modelValue","items"])]),u(j(A),{id:"my-chart-id",options:W,data:l.value},null,8,["data"])])]),o("div",pe,[fe,o("div",be,[o("div",ve,[u(y,{label:"Outcome",modelValue:f.value,"onUpdate:modelValue":s[4]||(s[4]=e=>f.value=e),items:m.value,variant:"solo","bg-color":"#F3F4F6",flat:"",density:"compact"},null,8,["modelValue","items"]),u(y,{label:"Student ID",modelValue:i.value,"onUpdate:modelValue":[s[5]||(s[5]=e=>i.value=e),s[6]||(s[6]=e=>{w(t.classCode,e),F(t.classCode,e)})],items:(c=v.value)==null?void 0:c.map(e=>e.student_id),variant:"solo",density:"compact","bg-color":"#F3F4F6",flat:""},null,8,["modelValue","items"])]),o("div",ge,[(V(!0),$(N,null,Q(b.value,(e,x)=>(V(),X(a,{index:x,exerciseCode:e.exercise_code,exerciseName:e.exercise_name},null,8,["index","exerciseCode","exerciseName"]))),256))])])])],16)}}}),Ce={class:"d-flex flex-row justify-space-between"},we=o("h1",{class:"w-75"},"Report & Suggestion",-1),xe={class:""},Ve=E({__name:"Report",setup(D){const i=_(),p=_(),f=_();async function m(){var b,t,r,g;const{data:v}=await h.get("/api/classes");f.value=v.map(l=>{const[k,C]=l.course.split("-"),w=l.class_code.split("_")[0].substring(2);return{name:C,course_code:k,class_code:l.class_code,group:l.group,semester:w,num_of_lab:l.num_of_lab,num_of_students:l.num_of_students,num_submit_file:l.num_submit_file,num_of_exercises:l.num_of_exercises,num_of_submissions:l.num_of_submissions}}),i.value=((t=(b=f.value)==null?void 0:b.at(0))==null?void 0:t.class_code)??"",p.value=((g=(r=f.value)==null?void 0:r.at(0))==null?void 0:g.num_of_lab)??0}return se(()=>{m()}),(v,b)=>{const t=oe,r=he;return V(),$(N,null,[u(t),u(ae,null,{default:te(()=>{var g;return[o("div",Ce,[we,u(y,{label:"Class",modelValue:i.value,"onUpdate:modelValue":b[0]||(b[0]=l=>i.value=l),items:(g=f.value)==null?void 0:g.map(l=>l.class_code),variant:"solo",density:"compact",class:"mr-2","bg-color":"#F3F4F6",flat:""},null,8,["modelValue","items"])]),o("div",xe,[u(r,{class:"w-100",title:"Learning Outcome Performance",classCode:i.value,numOfLab:p.value},null,8,["classCode","numOfLab"])])]}),_:1})],64)}}});export{Ve as default};
