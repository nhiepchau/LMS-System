import{R as M,bg as H,a6 as G,bh as K,bi as J,bj as W,bk as X,ac as Y,a8 as Z,aR as ee,T as te,aS as se,ad as ae,ae as oe,bl as le,bm as ne,bn as ie,bo as ue,bp as re,ag as de,U as ce,b as e,d as L,r as h,y as me,C as N,o as j,a as S,c as R,w as n,j as F,B as pe,m as $,e as d,b8 as U,i as O,t as B,q as C,h as P,b7 as z,N as fe,V as ve,f as E,g as w,k as D,Q as _e,n as be,p as ge,s as he,O as ye,H as I,v as Q,x as xe,F as Ve,_ as ke}from"./index-Cc2wFGp6.js";import{V as we}from"./VForm-BOHvNMSk.js";import{_ as Ce}from"./FileInput.vue_vue_type_script_setup_true_lang-Dc0AeFc8.js";import{u as qe}from"./course-YisUOFuA.js";import{V as T}from"./VDialog-m9a34H3S.js";import{q as $e}from"./VDataTable-BRXGBBmZ.js";import"./VTable-DFDSBb63.js";const Se=M({color:String,...H(),...G(),...K(),...J(),...W(),...X(),...Y(),...Z(),...ee()},"VSheet"),Fe=te()({name:"VSheet",props:Se(),setup(u,V){let{slots:p}=V;const{themeClasses:f}=se(u),{backgroundColorClasses:x,backgroundColorStyles:v}=ae(oe(u,"color")),{borderClasses:r}=le(u),{dimensionStyles:m}=ne(u),{elevationClasses:y}=ie(u),{locationStyles:o}=ue(u),{positionClasses:k}=re(u),{roundedClasses:_}=de(u);return ce(()=>e(u.tag,{class:["v-sheet",f.value,x.value,r.value,y.value,k.value,_.value,u.class],style:[v.value,m.value,o.value,u.style]},p)),{}}}),Pe=d("h2",{class:"text-primary mb-5 text-left"},"Add new question?",-1),Ue=d("h3",{class:"text-primary text-left mb-2"},"General information",-1),Ie={class:"d-flex flex-row justify-space-between"},Be=d("h3",{class:"text-primary text-left mb-2"},"Others",-1),Ee={class:"d-flex flex-row justify-space-between mt-1"},De={class:"mt-3 d-flex flex-row justify-end"},Le=L({__name:"AddQuestionForm",props:{numOfLab:{type:Number,default:0},classCode:{type:String,default:""}},emits:["openQuestionForm"],setup(u,{emit:V}){const p=V,f=u,x=[{title:"Easy",value:1},{title:"Medium",value:2},{title:"Hard",value:3}],v=h(!1),r=h(),m=h(),y=h(),o=me({question:{description:"",lab:"",topic:"",level:void 0,question_id:"",question_code:"",url:""}});function k(){const i=Array.from({length:f.numOfLab},(t,l)=>l+1).map(t=>t);let s=[];return i.forEach(t=>{s.push(`${t}-pre`),s.push(`${t}-in`),s.push(`${t}-post`)}),s}function _(i){return i==="Hard"?"red":i==="Medium"?"orange":"green"}function g(i,s){return(""+i.code).localeCompare(s.code)}function c(i){return!!i||"Field is required"}async function q(){const i=f.classCode.substring(6,12);await P.get(`/api/courses/${i}/outcomes`).then(function(s){const{data:t}=s;y.value=t.map(l=>({pk:l.pk,code:l.outcome_code})).sort(g)})}const b=N("create-notification");async function a(){v.value=!0,setTimeout(async()=>{await P.post(`/api/classes/${f.classCode}/labs/${r.value}/exercises/`,{exercise_id:o.question.question_id,exercise_code:o.question.question_code,exercise_name:o.question.description,class_code:f.classCode,level:o.question.level,topic:o.question.topic,outcome:m.value,url:o.question.url}).then(function(i){v.value=!1,b({type:"success",message:"Create question successfully!"}),p("openQuestionForm",!1)}).catch(()=>{v.value=!1,b({type:"error",message:"Failed to create new question!"}),p("openQuestionForm",!1)})},1e3)}return j(()=>{q()}),(i,s)=>(S(),R(Fe,{class:"mx-auto w-50 pa-5 text-right"},{default:n(()=>[Pe,e(F,{class:"mb-4"}),e(we,{"validate-on":"submit lazy",onSubmit:pe(a,["prevent"])},{default:n(()=>[Ue,e($,{label:"Question name",density:"comfortable",variant:"outlined",class:"mt-1",rules:[c],modelValue:o.question.description,"onUpdate:modelValue":s[0]||(s[0]=t=>o.question.description=t)},null,8,["rules","modelValue"]),d("div",Ie,[e($,{label:"Question code",density:"comfortable",variant:"outlined",class:"w-25 mr-4",rules:[c],modelValue:o.question.question_code,"onUpdate:modelValue":s[1]||(s[1]=t=>o.question.question_code=t)},null,8,["rules","modelValue"]),e($,{label:"Question id",density:"comfortable",variant:"outlined",class:"w-25 mr-4",rules:[c],modelValue:o.question.question_id,"onUpdate:modelValue":s[2]||(s[2]=t=>o.question.question_id=t)},null,8,["rules","modelValue"]),e(U,{label:"Level",items:x,modelValue:o.question.level,"onUpdate:modelValue":s[3]||(s[3]=t=>o.question.level=t),variant:"outlined",density:"comfortable",rules:[c],style:{width:"100px"}},{selection:n(({item:t,index:l})=>[e(O,{color:_(t.title)},{default:n(()=>[d("span",null,B(t.title),1)]),_:2},1032,["color"])]),_:1},8,["modelValue","rules"])]),e(F,{class:"my-2"}),Be,d("div",Ee,[e($,{label:"Topic",density:"comfortable",variant:"outlined",class:"w-25 mr-4",rules:[c],modelValue:o.question.topic,"onUpdate:modelValue":s[4]||(s[4]=t=>o.question.topic=t)},null,8,["rules","modelValue"]),e(U,{label:"Lab",items:k(),modelValue:r.value,"onUpdate:modelValue":s[5]||(s[5]=t=>r.value=t),variant:"outlined",density:"comfortable",rules:[c],class:"w-25 mr-4"},null,8,["items","modelValue","rules"]),e(U,{label:"Outcome",items:y.value,"item-title":"code","item-value":"pk",modelValue:m.value,"onUpdate:modelValue":s[6]||(s[6]=t=>m.value=t),variant:"outlined",density:"comfortable",rules:[c],style:{width:"100px"}},null,8,["items","modelValue","rules"])]),e($,{label:"BKel Link",density:"comfortable",variant:"outlined",class:"mt-1",rules:[c],modelValue:o.question.url,"onUpdate:modelValue":s[7]||(s[7]=t=>o.question.url=t)},null,8,["rules","modelValue"]),e(F),d("div",De,[e(C,{text:"Close",class:"text-none bg-grey-lighten-3 mr-3",flat:"",onClick:s[8]||(s[8]=t=>p("openQuestionForm",!1)),disabled:v.value},null,8,["disabled"]),e(C,{class:"text-none bg-light-blue",text:"Submit",type:"submit",flat:"",loading:v.value},null,8,["loading"])])]),_:1})]),_:1}))}}),Oe={class:"d-flex flex-row text-primary mb-2"},Qe=d("h2",{class:"my-auto"},"Import new file",-1),Te=d("p",{class:"mt-4"},"Please import more question data for the student ",-1),Ne={class:"border-sm rounded pa-4 my-4 mx-auto",style:{height:"250px"}},je={class:"d-flex flex-row text-primary"},Re=d("h3",null,"Exercise file",-1),ze={key:0,class:"mt-15"},Ae={key:1,class:"text-center mt-10"},Me=L({__name:"ImportCard",props:{classId:{type:Number,required:!0}},emits:["openImportCard"],setup(u,{emit:V}){const p=V,f=u,x=z(),v=fe(),r=h(),m=h(!1),y=N("create-notification"),o="http://127.0.0.1:8000";async function k(){if(r.value){const _=new FormData;_.append("exercise_file",r.value),_.append("class_code",`${f.classId}`),console.log("FormData ",_),m.value=!0,await ye.post(`${o}/api/classes/${x.params.class_code}/exercises/upload`,_,{headers:{Authorization:`Bearer ${v.token}`,"Content-Type":"multipart/form-data"}}).then(function(g){var c;m.value=!1,p("openImportCard",!1),y({type:"success",message:`Uploaded file ${(c=r.value)==null?void 0:c.name} successfully!`})}).catch(function(){m.value=!1,p("openImportCard",!1),y({type:"error",message:"Something's wrong when uploading!"})})}}return(_,g)=>{const c=Ce;return S(),R(he,{class:"w-66 mx-auto text-secondary"},{default:n(()=>[e(ve,null,{default:n(()=>[d("div",Oe,[Qe,e(E,{size:"md",class:"ml-2 my-auto"},{default:n(()=>[w("fas fa-chevron-right")]),_:1}),e(O,{class:"ml-4 my-auto"},{default:n(()=>[w("Exercises")]),_:1})]),e(F),Te,d("div",Ne,[d("div",je,[e(E,{class:"mr-2"},{default:n(()=>[w("fas fa-file-alt")]),_:1}),Re]),m.value?(S(),D("div",Ae,[e(_e,{size:100,width:7,color:"primary",indeterminate:""})])):(S(),D("div",ze,[e(c,{idx:0,type:"Exercise",onUploadFile:g[0]||(g[0]=q=>r.value=q)})]))])]),_:1}),e(F,{class:"my-1"}),e(be,null,{default:n(()=>[e(ge),e(C,{text:"Close",class:"text-none bg-blue-lighten-5 text-blue-darken-2",onClick:g[1]||(g[1]=q=>p("openImportCard",!1)),disabled:m.value},null,8,["disabled"]),e(C,{class:"text-none bg-primary",text:"Save",onClick:k,disabled:m.value},null,8,["disabled"])]),_:1})]),_:1})}}}),He={class:"d-flex flex-row w-100 justify-space-between"},Ge={class:"text-primary"},tt=L({__name:"Exercise",setup(u){const V=z(),p=h(!1),f=h(!1),x=h(0),v=h(0),r=V.params.class_code.toString(),m=qe();async function y(){const b=r.substring(6,12),{data:a}=await P.get(`/api/courses/${b}/classes/${r}`);x.value=a.pk,v.value=a.num_of_lab}const o=["https://lms.hcmut.edu.vn/mod/assign/view.php?id=258504","https://lms.hcmut.edu.vn/mod/assign/view.php?id=258505","https://lms.hcmut.edu.vn/mod/assign/view.php?id=258520","https://lms.hcmut.edu.vn/mod/assign/view.php?id=258508","https://lms.hcmut.edu.vn/mod/assign/view.php?id=258512","https://lms.hcmut.edu.vn/mod/assign/view.php?id=258529","https://lms.hcmut.edu.vn/mod/assign/view.php?id=258532","https://lms.hcmut.edu.vn/mod/assign/view.php?id=258516","https://lms.hcmut.edu.vn/mod/assign/view.php?id=258517","https://lms.hcmut.edu.vn/mod/assign/view.php?id=258533"];function k(b){const a=parseInt(b.split("?id=")[1]),i=o[a%10];window.open(i,"_blank")}const _=h();async function g(){const{data:b}=await P.get(`/api/classes/${r}/exercises`);_.value=b.map(a=>{const i=a.level===1?"1-easy":a.level===2?"2-medium":a.level===3?"3-hard":"";return{question:a.exercise_code,name:a.exercise_name,level:i,topic:a.topic,lab_id:a.lab,outcome_id:a.outcome,bkel_link:a.url}})}j(async()=>{await y(),await g()});function c(b){return b==="3-hard"?"red":b==="2-medium"?"orange":"green"}const q=[{title:"question",align:"start",key:"question",sortable:!1},{title:"name",align:"start",key:"name",sortable:!1},{title:"level",align:"start",key:"level",sortable:!1},{title:"topic",align:"start",key:"topic",sortable:!1},{title:"lab_id",align:"start",key:"lab_id",sortable:!1},{title:"outcome_id",align:"start",key:"outcome_id",sortable:!1},{title:"bkel_link",align:"center",key:"bkel_link",sortable:!1}];return(b,a)=>{const i=ke,s=Me,t=Le;return S(),D(Ve,null,[e(i),e(xe,null,{default:n(()=>[d("div",He,[d("h1",Ge," ["+B(I(r).substring(6))+"] Exercises ",1),d("div",null,[e(T,{modelValue:p.value,"onUpdate:modelValue":a[2]||(a[2]=l=>p.value=l)},{activator:n(({props:l})=>[e(C,Q({onClick:a[0]||(a[0]=A=>I(m).resetCourse()),variant:"outlined"},l,{class:"text-none text-primary mr-3","prepend-icon":"fas fa-file-upload"}),{default:n(()=>[w("Import")]),_:2},1040)]),default:n(()=>[e(s,{classId:x.value,onOpenImportCard:a[1]||(a[1]=l=>{p.value=l,g()})},null,8,["classId"])]),_:1},8,["modelValue"]),e(T,{modelValue:f.value,"onUpdate:modelValue":a[4]||(a[4]=l=>f.value=l)},{activator:n(({props:l})=>[e(C,Q({variant:"flat",height:"40"},l,{class:"text-none bg-primary text-white","prepend-icon":"fas fa-plus"}),{default:n(()=>[w("New question")]),_:2},1040)]),default:n(()=>[e(t,{numOfLab:v.value,classCode:I(r),onOpenQuestionForm:a[3]||(a[3]=l=>{f.value=l,g()})},null,8,["numOfLab","classCode"])]),_:1},8,["modelValue"])])]),e($e,{class:"border-sm rounded-lg mt-8",items:_.value,headers:q,"item-value":"name","show-select":""},{"item.level":n(({value:l})=>[e(O,{color:c(l)},{default:n(()=>[w(B(l),1)]),_:2},1032,["color"])]),"item.bkel_link":n(({value:l})=>[e(C,{icon:"",variant:"plain",onClick:A=>k(l)},{default:n(()=>[e(E,{size:"xsmall",class:"text-dark-grey"},{default:n(()=>[w("fas fa-link")]),_:1})]),_:2},1032,["onClick"])]),_:1},8,["items"])]),_:1})],64)}}});export{tt as default};
