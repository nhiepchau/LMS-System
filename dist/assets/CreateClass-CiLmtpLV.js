import{d as T,a as b,k as $,e as c,b as o,w as i,g as k,f as D,G as ve,t as U,F as S,r as O,y as ue,o as oe,N as Z,O as G,l as L,H as B,c as I,E as _e,m as ae,P as E,h as M,q as F,B as P,Q as ye,R as q,S as he,T as W,U as H,v as X,W as ie,X as ge,Y as Ce,Z as Ve,$ as se,a0 as xe,a1 as Y,a2 as ke,a3 as we,a4 as ne,a5 as $e,a6 as Se,A as ee,z as Ie,j as Oe,a7 as le,a8 as Be,a9 as ce,aa as De,ab as Le,ac as Ne,ad as Ue,ae as Re,af as R,ag as Ee,ah as Fe,ai as Pe,aj as Te,ak as Ae,x as ze,D as je,C as Ge,_ as Me}from"./index-MoPcLG9q.js";import{u as K}from"./course-CL_v0EK1.js";import{a as z,V as Q,c as j,b as J}from"./VWindowItem-BkqGcVEj.js";import{V as qe,a as re}from"./VCombobox-CK7DBaKP.js";import{_ as We}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as de}from"./FileInput.vue_vue_type_script_setup_true_lang-4mwtK9wc.js";import{V as He}from"./VTable-DrOtf772.js";import"./VDataTable-BW5uJkcr.js";const Qe={class:"d-flex flex-row"},Je=c("h3",{class:"my-auto text-primary"},"Analysis",-1),Xe=c("p",{class:"text-dark-grey"},"Process all of your input",-1),Ye={class:"mt-16 mx-auto",style:{height:"200px",width:"80%"}},Ze={key:0,class:"ma-auto text-center"},Ke=c("p",{class:"mt-4 text-primary"},"In progress to send request to system. Wait few minutes for processing!",-1),et={key:1,class:"text-center"},tt=c("h1",{class:"text-error text-lg font-weight-bold mb-5"},"Error!",-1),at={class:"mt-4 text-error font-weight-medium"},st=T({__name:"AnalysisForm",props:{loading:{type:Boolean,default:!0},errorMessage:{type:String,default:""}},setup(s){return(u,a)=>(b(),$(S,null,[c("div",Qe,[o(D,{class:"my-auto mr-2 text-sub",size:"small"},{default:i(()=>[k("fas fa-undo-alt")]),_:1}),Je]),Xe,c("div",Ye,[s.errorMessage===""?(b(),$("div",Ze,[o(ve,{color:"blue-darken-1","model-value":"100",rounded:"",indeterminate:s.loading},null,8,["indeterminate"]),Ke])):(b(),$("div",et,[tt,c("p",at,U(s.errorMessage),1)]))])],64))}}),ot=T({__name:"DistributionForm",props:{classIdx:{type:Number,required:!0},outcomes:{type:Array,default:[]}},setup(s){const u=s;function a(r,l,n){return n.indexOf(r)===l}const p=K(),_=u.outcomes.map(r=>r.parent_outcome).filter(a),v=O(""),y=p.selectedCourse.NumOfLabs,g=Array.from({length:y},(r,l)=>l+1).map(r=>r);function V(){const r=g.map(n=>({title:`Lab ${n}`,align:"center",sortable:!1,width:120,key:`lab_${n}`,value:f=>f.labs[n-1]})),l=[{title:"LO",align:"start",key:"outcome",sortable:!1}];return l.push(...r),l.push({title:"Total",align:"center",key:"total",sortable:!1,value:n=>g.reduce((f,w)=>f+(n.labs[w-1]!==-1?n.labs[w-1]:0),0)},{title:"Threshold",align:"center",sortable:!1,key:"threshold"}),l}function x(r,l){return(""+r.outcome).localeCompare(l.outcome)}let C=p.getValidClasses()[u.classIdx];function d(){const r={};return C.RawOutcomes.length>0?_.forEach(l=>{const n=C.RawOutcomes.filter(f=>f.Outcome.substring(0,5)==l);r[l]=n.map(f=>({outcome:f.Outcome,labs:f.Labs,threshold:f.Threshold})).sort(x)}):_.forEach(l=>{const n=u.outcomes.filter(f=>f.parent_outcome==l);r[l]=n.map(f=>({outcome:f.outcome_code,labs:Array.from(Array(y).values()).map(w=>-1),threshold:f.threshold})).sort(x)}),console.log("Result ",r),r}const h=ue(d());oe(async()=>{C.RawOutcomes.length<=0&&await t()});function m(r){return g.reduce((l,n)=>l+(!r.labs[n-1]||r.labs[n-1]===-1?0:parseInt(r.labs[n-1])),0)}function e(){let r=[],l=[];_.forEach(n=>{h[n].forEach(f=>{f.labs.forEach((w,N)=>{w>0&&r.push({Outcome:f.outcome,Lab:N+1,Contribution:w/100})}),l.push({Outcome:f.outcome,Labs:f.labs,Threshold:f.threshold})})}),console.log("New outcomes ",r),p.setOutcomes(u.classIdx,r),p.setRawOutcomes(u.classIdx,l)}async function t(){const r=new FormData,l=Z(),n=p.selectedCourse.CourseCode;C.Exercise&&(r.append("exercise_file",C.Exercise),await G.post(`http://127.0.0.1:8000/api/courses/${n}/exercises/analyze`,r,{headers:{Authorization:`Bearer ${l.token}`,"Content-Type":"multipart/form-data"}}).then(async function(w){const{data:N}=w;N.forEach(A=>{const me=A.outcome_code.substring(0,5);A.labs.forEach(fe=>{const pe=parseInt(fe.substring(4));h[me].find(be=>be.outcome===A.outcome_code).labs[pe-1]=void 0})})}))}return(r,l)=>(b(),$(S,null,[o(Q,{modelValue:v.value,"onUpdate:modelValue":l[0]||(l[0]=n=>v.value=n)},{default:i(()=>[(b(!0),$(S,null,L(B(_),(n,f)=>(b(),I(z,{key:f,value:n},{default:i(()=>[k(U(n),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),o(J,{modelValue:v.value,"onUpdate:modelValue":l[1]||(l[1]=n=>v.value=n),class:"mt-3"},{default:i(()=>[(b(!0),$(S,null,L(B(_),(n,f)=>(b(),I(j,{key:f,value:n},{default:i(()=>[o(qe,{headers:V(),items:h[n],"item-value":"outcome"},_e({"item.total":i(({item:w})=>[o(D,{size:"small"},{default:i(()=>[k("fas fa-bolt")]),_:1}),k("  "+U(m(w))+"% ",1)]),_:2},[L(B(g),w=>({name:`item.lab_${w}`,fn:i(({item:N})=>[N.labs[w-1]!==-1?(b(),I(ae,{key:0,placeholder:"%",density:"compact",flat:"",variant:"outlined",class:"my-1 text-sm-body-1",color:"dark-grey","model-value":parseInt(N.labs[w-1]),"onUpdate:modelValue":A=>{N.labs[w-1]=parseInt(A),e()},type:"number"},null,8,["model-value","onUpdate:modelValue"])):E("",!0)])}))]),1032,["headers","items"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])],64))}}),lt=We(ot,[["__scopeId","data-v-6847d224"]]),nt={class:"mt-3 w-100"},rt=c("h3",null,"Classes",-1),ut=c("p",null,"Exercise for each class",-1),it={class:"d-flex flex-row mt-5"},ct={class:"d-flex flex-row justify-space-between"},dt={class:"d-flex flex-row text-primary"},mt=c("h3",null,"Submissions file",-1),ft={class:"mt-15"},pt=c("div",{class:"mt-3"},[c("h3",null,"Distribution"),c("p",null,"Exercise for each class")],-1),bt={class:"d-flex flex-row mt-5"},vt=c("h3",{class:"text-primary"},"Learning outcome distribution",-1),_t=c("p",{class:"text-dark-grey text-sm-body-2"},"Loading learning outcome details from your data",-1),yt={key:0,class:"text-center mt-10"},ht=c("p",{class:"mt-5"},"Just one second",-1),gt=T({__name:"SubmissionForm",setup(s){const u=O(""),a=O(""),p=O(!0),_=K(),v=_.selectedCourse.CourseCode,y=_.getValidClasses(),g=O();oe(()=>{V()});async function V(){await M.get(`/api/courses/${v}/outcomes`).then(function(C){p.value=!1;const{data:d}=C;g.value=d.map(h=>({pk:h.pk,outcome_code:h.outcome_code,parent_outcome:h.parent_outcome,threshold:h.threshold}))})}async function x(){const C="http://127.0.0.1:8000",d=Z();await G.get(`${C}/api/sample/submission/download`,{headers:{Authorization:`Bearer ${d.token}`,"Content-Type":"multipart/form-data"},responseType:"blob"}).then(function(h){const m=new Blob([h.data],{type:"text/csv"}),e=document.createElement("a");e.href=URL.createObjectURL(m),e.download="Submission-Sample.csv",e.click(),URL.revokeObjectURL(e.href)})}return(C,d)=>{const h=de,m=lt;return b(),$(S,null,[o(Q,{modelValue:u.value,"onUpdate:modelValue":d[0]||(d[0]=e=>u.value=e),class:"w-100"},{default:i(()=>[o(z,{class:"text-none",value:"Submissions"},{default:i(()=>[o(D,null,{default:i(()=>[k("fas fa-circle-check")]),_:1}),k("  Submissions")]),_:1}),o(z,{class:"text-none",value:"LODistribution"},{default:i(()=>[k("LO Distribution")]),_:1})]),_:1},8,["modelValue"]),o(J,{class:"mt-3 w-100",modelValue:u.value,"onUpdate:modelValue":d[6]||(d[6]=e=>u.value=e)},{default:i(()=>[o(j,{value:"Submissions"},{default:i(()=>[c("div",nt,[rt,ut,c("div",it,[o(Q,{direction:"vertical",modelValue:a.value,"onUpdate:modelValue":d[1]||(d[1]=e=>a.value=e),class:"w-25"},{default:i(()=>[(b(!0),$(S,null,L(B(y),(e,t)=>(b(),I(z,{key:t,value:e.Name},{default:i(()=>[k(U(e.Name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),o(J,{modelValue:a.value,"onUpdate:modelValue":d[3]||(d[3]=e=>a.value=e),class:"border-sm rounded w-75 pa-4",style:{height:"250px","margin-top":"-70px"}},{default:i(()=>[(b(!0),$(S,null,L(B(y),(e,t)=>(b(),I(j,{key:t,value:e.Name},{default:i(()=>[c("div",ct,[c("div",dt,[o(D,{class:"mr-2"},{default:i(()=>[k("fas fa-file-alt")]),_:1}),mt]),o(F,{class:"text-none text-sm-caption bg-light-blue",flat:"",density:"compact",onClick:d[2]||(d[2]=P(r=>x(),["prevent"])),"prepend-icon":"fas fa-cloud-arrow-down"},{default:i(()=>[k("Download sample?")]),_:1})]),c("div",ft,[o(h,{idx:t,type:"Submission"},null,8,["idx"])])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])])]),_:1}),o(j,{value:"LODistribution"},{default:i(()=>[pt,c("div",bt,[o(Q,{direction:"vertical",modelValue:a.value,"onUpdate:modelValue":d[4]||(d[4]=e=>a.value=e),class:"w-25"},{default:i(()=>[(b(!0),$(S,null,L(B(y),(e,t)=>(b(),I(z,{key:t,value:e.Name},{default:i(()=>[k(U(e.Name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),o(J,{modelValue:a.value,"onUpdate:modelValue":d[5]||(d[5]=e=>a.value=e),class:"border-sm rounded w-75 pa-4",style:{height:"500px","margin-top":"-70px"}},{default:i(()=>[(b(!0),$(S,null,L(B(y),(e,t)=>(b(),I(j,{key:t,value:e.Name},{default:i(()=>[vt,_t,p.value?(b(),$("div",yt,[o(ye,{size:70,width:7,color:"dark-grey",indeterminate:""}),ht])):(b(),I(m,{key:1,outcomes:g.value,classIdx:t},null,8,["outcomes","classIdx"]))]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),_:1},8,["modelValue"])],64)}}}),Ct=q({...he({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),Vt=W()({name:"VRadio",props:Ct(),setup(s,u){let{slots:a}=u;return H(()=>o(ie,X(s,{class:["v-radio",s.class],style:s.style,type:"radio"}),a)),{}}}),xt=q({height:{type:[Number,String],default:"auto"},...ge(),...Ce(Ve(),["multiple"]),trueIcon:{type:se,default:"$radioOn"},falseIcon:{type:se,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),kt=W()({name:"VRadioGroup",inheritAttrs:!1,props:xt(),emits:{"update:modelValue":s=>!0},setup(s,u){let{attrs:a,slots:p}=u;const _=xe(),v=Y(()=>s.id||`radio-group-${_}`),y=ke(s,"modelValue");return H(()=>{const[g,V]=we(a),x=ne.filterProps(s),C=ie.filterProps(s),d=p.label?p.label({label:s.label,props:{for:v.value}}):s.label;return o(ne,X({class:["v-radio-group",s.class],style:s.style},g,x,{modelValue:y.value,"onUpdate:modelValue":h=>y.value=h,id:v.value}),{...p,default:h=>{let{id:m,messagesId:e,isDisabled:t,isReadonly:r}=h;return o(S,null,[d&&o($e,{id:m.value},{default:()=>[d]}),o(Se,X(C,{id:m.value,"aria-describedby":e.value,defaultsTarget:"VRadio",trueIcon:s.trueIcon,falseIcon:s.falseIcon,type:s.type,disabled:t.value,readonly:r.value,"aria-labelledby":d?m.value:void 0,multiple:!1},V,{modelValue:y.value,"onUpdate:modelValue":l=>y.value=l}),p)])}})}),{}}}),wt={class:"d-flex flex-row"},$t=c("h3",{class:"my-auto text-primary"},"General Information",-1),St={class:"d-flex flex-row mt-4"},It=c("h3",{class:"my-auto text-primary"},"Classes",-1),Ot=c("th",null,"Class",-1),Bt={class:"w-50"},Dt={class:"d-flex flex-row justify-space-between"},Lt=c("span",{class:"my-auto"},"Exercises file",-1),Nt=c("th",null,"Default",-1),Ut={class:"w-50"},Rt=T({__name:"CreateClassForm",setup(s){const u=K(),a=O(""),p=O(""),_=O(),v=O(),y=O(),g=ue({classes:[{Name:"",Default:!1}]});oe(()=>{V(),x();var e=u.getValidClasses();e.length>0&&(g.classes=e),a.value=u.selectedCourse.CourseName,p.value=u.selectedCourse.Semester,_.value=u.selectedCourse.NumOfLabs});async function V(){const{data:e}=await M.get("/api/courses");v.value=e.map(t=>({pk:t.pk,course_code:t.course_code,course_name:t.course_name}))}async function x(){const{data:e}=await M.get("/api/courses/semesters");y.value=e.map(t=>({pk:t.pk,semester_name:t.semester_name}))}async function C(){const e="http://127.0.0.1:8000",t=Z();await G.get(`${e}/api/sample/question/download`,{headers:{Authorization:`Bearer ${t.token}`,"Content-Type":"multipart/form-data"},responseType:"blob"}).then(function(r){const l=new Blob([r.data],{type:"text/csv"}),n=document.createElement("a");n.href=URL.createObjectURL(l),n.download="Question-Sample.csv",n.click(),URL.revokeObjectURL(n.href)})}function d(){g.classes.push({Name:"",Default:!1,Outcomes:[],RawOutcomes:[]}),u.addClass({Name:"",Default:!1,Outcomes:[],RawOutcomes:[]})}function h(e){var r,l;let t=e??"";u.editCourse("CourseName",t),u.editCourse("CourseCode",((l=(r=v.value)==null?void 0:r.find(n=>n.course_name==t))==null?void 0:l.course_code)??"")}function m(e){var r,l;let t=e??"";u.editCourse("Semester",t),u.editCourse("SemesterId",((l=(r=y.value)==null?void 0:r.find(n=>n.semester_name==t))==null?void 0:l.pk)??0)}return(e,t)=>{const r=de;return b(),$(S,null,[c("div",wt,[o(D,{class:"my-auto mr-2 text-sub",size:"small"},{default:i(()=>[k("fas fa-info-circle")]),_:1}),$t]),o(Ie,{class:"mt-4"},{default:i(()=>[o(ee,{cols:"6"},{default:i(()=>{var l;return[o(re,{label:"Course Name",items:(l=v.value)==null?void 0:l.map(n=>n.course_name),variant:"outlined",color:"sub","bg-color":"#F3F4F6",density:"comfortable",modelValue:a.value,"onUpdate:modelValue":[t[0]||(t[0]=n=>a.value=n),t[1]||(t[1]=n=>h(n))]},null,8,["items","modelValue"])]}),_:1}),o(ee,{cols:"3"},{default:i(()=>{var l;return[o(re,{label:"Semester",items:(l=y.value)==null?void 0:l.map(n=>n.semester_name),variant:"outlined",color:"sub","bg-color":"#F3F4F6",density:"comfortable",modelValue:p.value,"onUpdate:modelValue":[t[2]||(t[2]=n=>p.value=n),t[3]||(t[3]=n=>m(n))]},null,8,["items","modelValue"])]}),_:1}),o(ee,{cols:"3"},{default:i(()=>[o(ae,{"bg-color":"#F3F4F6",label:"No. of Lab",color:"sub",placeholder:"Enter number of labs",variant:"outlined",density:"comfortable",modelValue:_.value,"onUpdate:modelValue":[t[4]||(t[4]=l=>_.value=l),t[5]||(t[5]=l=>B(u).editCourse("NumOfLabs",parseInt(l)))]},null,8,["modelValue"])]),_:1})]),_:1}),o(Oe,{class:"my-2"}),c("div",St,[o(D,{class:"my-auto mr-2 text-sub",size:"small"},{default:i(()=>[k("far fa-calendar")]),_:1}),It]),o(He,null,{default:i(()=>[c("thead",null,[c("tr",null,[Ot,c("th",Bt,[c("div",Dt,[Lt,o(F,{class:"text-none text-sm-caption bg-light-blue",flat:"",density:"compact",onClick:t[6]||(t[6]=P(l=>C(),["prevent"])),"prepend-icon":"fas fa-cloud-arrow-down"},{default:i(()=>[k("Download sample?")]),_:1})])]),Nt])]),c("tbody",null,[(b(!0),$(S,null,L(g.classes,(l,n)=>(b(),$("tr",{key:n},[c("td",null,[o(ae,{rounded:"md","bg-color":"#F3F4F6",color:"sub",variant:"outlined",placeholder:"Class",class:"my-2",density:"compact",modelValue:l.Name,"onUpdate:modelValue":[f=>l.Name=f,f=>B(u).setClassName(n,l.Name)]},null,8,["modelValue","onUpdate:modelValue"])]),c("td",Ut,[o(r,{idx:n,type:"Exercise"},null,8,["idx"])]),c("td",null,[o(kt,{color:"#4B7BEC",modelValue:l.Default,"onUpdate:modelValue":[f=>l.Default=f,f=>B(u).setClassDefault(n,l.Default)]},{default:i(()=>[o(Vt,{class:"text-blue-darken-4",label:"Apply for other classes"})]),_:2},1032,["modelValue","onUpdate:modelValue"])])]))),128))])]),_:1}),o(F,{onClick:t[7]||(t[7]=P(l=>d(),["prevent"])),variant:"plain",class:"text-none text-primary","prepend-icon":"fas fa-plus"},{default:i(()=>[k("Add more class")]),_:1})],64)}}}),Et=q({divider:[Number,String],...le()},"VBreadcrumbsDivider"),Ft=W()({name:"VBreadcrumbsDivider",props:Et(),setup(s,u){let{slots:a}=u;return H(()=>{var p;return o("li",{class:["v-breadcrumbs-divider",s.class],style:s.style},[((p=a==null?void 0:a.default)==null?void 0:p.call(a))??s.divider])}),{}}}),Pt=q({active:Boolean,activeClass:String,activeColor:String,color:String,disabled:Boolean,title:String,...le(),...Be(),...ce({tag:"li"})},"VBreadcrumbsItem"),Tt=W()({name:"VBreadcrumbsItem",props:Pt(),setup(s,u){let{slots:a,attrs:p}=u;const _=De(s,p),v=Y(()=>{var x;return s.active||((x=_.isActive)==null?void 0:x.value)}),y=Y(()=>v.value?s.activeColor:s.color),{textColorClasses:g,textColorStyles:V}=Le(y);return H(()=>o(s.tag,{class:["v-breadcrumbs-item",{"v-breadcrumbs-item--active":v.value,"v-breadcrumbs-item--disabled":s.disabled,[`${s.activeClass}`]:v.value&&s.activeClass},g.value,s.class],style:[V.value,s.style],"aria-current":v.value?"page":void 0},{default:()=>{var x,C;return[_.isLink.value?o("a",{class:"v-breadcrumbs-item--link",href:_.href.value,"aria-current":v.value?"page":void 0,onClick:_.navigate},[((C=a.default)==null?void 0:C.call(a))??s.title]):((x=a.default)==null?void 0:x.call(a))??s.title]}})),{}}}),At=q({activeClass:String,activeColor:String,bgColor:String,color:String,disabled:Boolean,divider:{type:String,default:"/"},icon:se,items:{type:Array,default:()=>[]},...le(),...Ne(),...Ue(),...ce({tag:"ul"})},"VBreadcrumbs"),zt=W()({name:"VBreadcrumbs",props:At(),setup(s,u){let{slots:a}=u;const{backgroundColorClasses:p,backgroundColorStyles:_}=Re(R(s,"bgColor")),{densityClasses:v}=Ee(s),{roundedClasses:y}=Fe(s);Pe({VBreadcrumbsDivider:{divider:R(s,"divider")},VBreadcrumbsItem:{activeClass:R(s,"activeClass"),activeColor:R(s,"activeColor"),color:R(s,"color"),disabled:R(s,"disabled")}});const g=Y(()=>s.items.map(V=>typeof V=="string"?{item:{title:V},raw:V}:{item:V,raw:V}));return H(()=>{const V=!!(a.prepend||s.icon);return o(s.tag,{class:["v-breadcrumbs",p.value,v.value,y.value,s.class],style:[_.value,s.style]},{default:()=>{var x;return[V&&o("li",{key:"prepend",class:"v-breadcrumbs__prepend"},[a.prepend?o(Te,{key:"prepend-defaults",disabled:!s.icon,defaults:{VIcon:{icon:s.icon,start:!0}}},a.prepend):o(D,{key:"prepend-icon",start:!0,icon:s.icon},null)]),g.value.map((C,d,h)=>{var t;let{item:m,raw:e}=C;return o(S,null,[((t=a.item)==null?void 0:t.call(a,{item:m,index:d}))??o(Tt,X({key:d,disabled:d>=h.length-1},typeof m=="string"?{title:m}:m),{default:a.title?()=>{var r;return(r=a.title)==null?void 0:r.call(a,{item:m,index:d})}:void 0}),d<h.length-1&&o(Ft,null,{default:a.divider?()=>{var r;return(r=a.divider)==null?void 0:r.call(a,{item:e,index:d})}:void 0})])}),(x=a.default)==null?void 0:x.call(a)]}})}),{}}}),jt=T({__name:"BreadCrumb",props:{activeIdx:{type:Number,default:0}},setup(s){const u=s,a=O([{title:"Classes & Exercises",icon:"fas fa-book",color:"#6F9CEB",disabled:!1},{title:"Submissions",icon:"fas fa-file-code",color:"",disabled:!0},{title:"Analysis",icon:"fas fa-chart-pie",color:"",disabled:!0}]);return Ae(()=>u.activeIdx,(p,_)=>{a.value.forEach(v=>{a.value[_].color="",a.value[_].disabled=!0,a.value[p].color="#6F9CEB",a.value[p].disabled=!1})}),(p,_)=>(b(),I(zt,{items:a.value,rounded:"",class:"bg-grey py-6 border-sm"},{divider:i(()=>[o(D,{size:"xsmall"},{default:i(()=>[k("fas fa-chevron-right")]),_:1})]),title:i(({item:v})=>[o(D,{size:"small"},{default:i(()=>[k(U(v.icon),1)]),_:2},1024),k("  "+U(v.title),1)]),_:1},8,["items"]))}}),Gt=c("h1",null,"Create classes",-1),Mt={class:"border-sm px-3 py-5 rounded mt-4"},qt={class:"mt-2 text-right"},te=2,ea=T({__name:"CreateClass",setup(s){const u=O(0),a=K(),p=Z(),_=je(),v="http://127.0.0.1:8000",y=Ge("create-notification"),g=O();function V(m){return!!(m.Submission&&m.Exercise&&m.Outcomes.length>0)}async function x(){u.value++;let m=a.getValidClasses();for(let e=0;e<m.length;e++){const t=m[e];V(t)?(await M.post(`/api/courses/${a.selectedCourse.CourseCode}/classes/`,{semester:a.selectedCourse.SemesterId,num_of_lab:a.selectedCourse.NumOfLabs,teacher:p.user.email,role:"Lecturer",group:t.Name}).then(async function(r){await C(t,{pk:r.data.pk,class_code:r.data.class_code}),setTimeout(()=>{_.push({name:"class-home"})},3e3)}),g.value=""):g.value="Make sure submit all submission file, exercise file and lab contributions!"}}async function C(m,e){const t=new FormData;m.Exercise&&(t.append("exercise_file",m.Exercise),t.append("class_code",`${e.pk}`),await G.post(`${v}/api/classes/${e.class_code}/exercises/upload`,t,{headers:{Authorization:`Bearer ${p.token}`,"Content-Type":"multipart/form-data"}}).then(async function(r){await h(m,e),await d(m,e)}))}async function d(m,e){const t=new FormData;m.Submission&&(t.append("submission_file",m.Submission),t.append("class_code",`${e.pk}`),await G.post(`${v}/api/classes/${e.class_code}/submissions/upload`,t,{headers:{Authorization:`Bearer ${p.token}`,"Content-Type":"multipart/form-data"}}).then(function(r){y({type:"success",message:"Submit for create course successfully! Please wait few minutes for processing and analyzing data!"})}).catch(function(){y({type:"error",message:"Something's wrong when uploading!"})}))}async function h(m,e){const t=m.Outcomes.map(r=>({outcome_code:r.Outcome,lab:r.Lab,contribution:r.Contribution}));await M.post(`/api/courses/${a.selectedCourse.CourseCode}/classes/${e.class_code}/labcontributions`,t)}return(m,e)=>{const t=Me,r=jt,l=Rt,n=gt,f=st;return b(),$(S,null,[o(t),o(ze,null,{default:i(()=>[Gt,o(r,{activeIdx:u.value,class:"my-2"},null,8,["activeIdx"]),c("div",Mt,[u.value===0?(b(),I(l,{key:0})):E("",!0),u.value===1?(b(),I(n,{key:1})):E("",!0),u.value===2?(b(),I(f,{key:2,"error-message":g.value},null,8,["error-message"])):E("",!0)]),c("div",qt,[o(F,{disabled:u.value<=0,variant:"plain",text:"Back","prepend-icon":"fas fa-arrow-left",class:"text-none bg-light-blue text-sub mr-3",onClick:e[0]||(e[0]=P(w=>u.value--,["prevent"]))},null,8,["disabled"]),u.value+1<te?(b(),I(F,{key:0,variant:"plain","append-icon":"fas fa-arrow-right",class:"text-none bg-primary",text:"Next",onClick:e[1]||(e[1]=P(w=>u.value++,["prevent"]))})):E("",!0),u.value+1>=te?(b(),I(F,{key:1,variant:"plain","append-icon":"fas fa-arrow-right",class:"text-none bg-primary",text:"Finish",disabled:u.value>=te,onClick:P(x,["prevent"])},null,8,["disabled"])):E("",!0)])]),_:1})],64)}}});export{ea as default};
