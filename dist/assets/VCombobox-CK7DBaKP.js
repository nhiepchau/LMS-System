import{m as Re,a as Fe,b as Se,c as Ae,d as _e,e as Ee,u as Be,f as De,p as Me,g as Ne,h as Oe,i as Le,j as Ue,k as Ge,l as Ke,V as ge,n as ye,o as He}from"./VDataTable-BW5uJkcr.js";import{R as Ce,al as je,T as Te,af as A,a1 as g,am as ze,an as _,ai as qe,U as Pe,b as u,ao as me,v as I,ap as We,aq as $e,Y as Je,ar as Ye,as as Qe,at as Xe,r as $,a2 as xe,au as Ze,ab as ea,av as aa,aw as la,ax as J,ak as G,ay as ta,az as Ve,aA as na,m as pe,F as Y,aB as ua,aC as oa,aD as we,aE as sa,aF as ia,aG as ra,f as ke,aH as ca,i as da,aj as va,g as fa,aI as ma,aJ as ha,aK as ba}from"./index-MoPcLG9q.js";import{V as Ie}from"./VTable-DrOtf772.js";const ga=Ce({...Re(),...Fe(),...je(),...Se()},"VDataTableVirtual"),ka=Te()({name:"VDataTableVirtual",props:ga(),emits:{"update:modelValue":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:groupBy":e=>!0,"update:expanded":e=>!0},setup(e,y){let{attrs:E,slots:l}=y;const{groupBy:C}=Ae(e),{sortBy:m,multiSort:x,mustSort:w}=_e(e),{columns:S,headers:K,filterFunctions:H,sortFunctions:O,sortRawFunctions:r}=Ee(e,{groupBy:C,showSelect:A(e,"showSelect"),showExpand:A(e,"showExpand")}),{items:i}=Be(e,S),B=A(e,"search"),{filteredItems:Q}=De(e,i,B,{transform:D=>D.columns,customKeyFilter:H}),{toggleSort:j}=Me({sortBy:m,multiSort:x,mustSort:w}),{sortByWithGroups:X,opened:Z,extractRows:ee,isGroupOpen:ae,toggleGroup:le}=Ne({groupBy:C,sortBy:m}),{sortedItems:o}=Oe(e,Q,X,O,r),{flatItems:k}=Le(o,C,Z),V=g(()=>ee(k.value)),{isSelected:d,select:te,selectAll:M,toggleSelect:ne,someSelected:h,allSelected:ue}=Ue(e,{allItems:V,currentPage:V}),{isExpanded:N,toggleExpand:L}=Ge(e),{containerRef:U,markerRef:oe,paddingTop:se,paddingBottom:ie,computedItems:re,handleItemResize:ce,handleScroll:de,handleScrollend:ve}=ze(e,k),p=g(()=>re.value.map(D=>D.raw));Ke({sortBy:m,page:_(1),itemsPerPage:_(-1),groupBy:C,search:B}),qe({VDataTableRows:{hideNoData:A(e,"hideNoData"),noDataText:A(e,"noDataText"),loading:A(e,"loading"),loadingText:A(e,"loadingText")}});const T=g(()=>({sortBy:m.value,toggleSort:j,someSelected:h.value,allSelected:ue.value,isSelected:d,select:te,selectAll:M,toggleSelect:ne,isExpanded:N,toggleExpand:L,isGroupOpen:ae,toggleGroup:le,items:V.value.map(D=>D.raw),internalItems:V.value,groupedItems:k.value,columns:S.value,headers:K.value}));Pe(()=>{const D=ge.filterProps(e),fe=ye.filterProps(e),z=Ie.filterProps(e);return u(Ie,I({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},z),{top:()=>{var a;return(a=l.top)==null?void 0:a.call(l,T.value)},wrapper:()=>{var a,n,s;return u("div",{ref:U,onScrollPassive:de,onScrollend:ve,class:"v-table__wrapper",style:{height:me(e.height)}},[u("table",null,[(a=l.colgroup)==null?void 0:a.call(l,T.value),u("thead",null,[u(ge,I(D,{sticky:e.fixedHeader}),l)]),u("tbody",null,[u("tr",{ref:oe,style:{height:me(se.value),border:0}},[u("td",{colspan:S.value.length,style:{height:0,border:0}},null)]),(n=l["body.prepend"])==null?void 0:n.call(l,T.value),u(ye,I(E,fe,{items:p.value}),{...l,item:c=>u(We,{key:c.internalItem.index,renderless:!0,"onUpdate:height":t=>ce(c.internalItem.index,t)},{default:t=>{var b;let{itemRef:v}=t;return((b=l.item)==null?void 0:b.call(l,{...c,itemRef:v}))??u(He,I(c.props,{ref:v,key:c.internalItem.index,index:c.internalItem.index}),l)}})}),(s=l["body.append"])==null?void 0:s.call(l,T.value),u("tr",{style:{height:me(ie.value),border:0}},[u("td",{colspan:S.value.length,style:{height:0,border:0}},null)])])])])},bottom:()=>{var a;return(a=l.bottom)==null?void 0:a.call(l,T.value)}})})}});function ya(e,y,E){if(y==null)return e;if(Array.isArray(y))throw new Error("Multiple matches is not implemented");return typeof y=="number"&&~y?u(Y,null,[u("span",{class:"v-combobox__unmask"},[e.substr(0,y)]),u("span",{class:"v-combobox__mask"},[e.substr(y,E)]),u("span",{class:"v-combobox__unmask"},[e.substr(y+E)])]):e}const xa=Ce({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...Se({filterKeys:["title"]}),...$e({hideNoData:!0,returnObject:!0}),...Je(Ye({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...Qe({transition:!1})},"VCombobox"),Ia=Te()({name:"VCombobox",props:xa(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:search":e=>!0,"update:menu":e=>!0},setup(e,y){var z;let{emit:E,slots:l}=y;const{t:C}=Xe(),m=$(),x=_(!1),w=_(!0),S=_(!1),K=$(),H=$(),O=xe(e,"menu"),r=g({get:()=>O.value,set:a=>{var n;O.value&&!a&&((n=K.value)!=null&&n.Î¨openChildren)||(O.value=a)}}),i=_(-1);let B=!1;const Q=g(()=>{var a;return(a=m.value)==null?void 0:a.color}),j=g(()=>r.value?e.closeText:e.openText),{items:X,transformIn:Z,transformOut:ee}=Ze(e),{textColorClasses:ae,textColorStyles:le}=ea(Q),o=xe(e,"modelValue",[],a=>Z(aa(a)),a=>{const n=ee(a);return e.multiple?n:n[0]??null}),k=la(),V=_(e.multiple?"":((z=o.value[0])==null?void 0:z.title)??""),d=g({get:()=>V.value,set:a=>{var n;if(V.value=a??"",e.multiple||(o.value=[J(e,a)]),a&&e.multiple&&((n=e.delimiters)!=null&&n.length)){const s=a.split(new RegExp(`(?:${e.delimiters.join("|")})+`));s.length>1&&(s.forEach(c=>{c=c.trim(),c&&p(J(e,c))}),V.value="")}a||(i.value=-1),w.value=!a}}),te=g(()=>typeof e.counterValue=="function"?e.counterValue(o.value):typeof e.counterValue=="number"?e.counterValue:e.multiple?o.value.length:d.value.length);G(V,a=>{B?Ve(()=>B=!1):x.value&&!r.value&&(r.value=!0),E("update:search",a)}),G(o,a=>{var n;e.multiple||(V.value=((n=a[0])==null?void 0:n.title)??"")});const{filteredItems:M,getMatches:ne}=De(e,X,()=>w.value?"":d.value),h=g(()=>e.hideSelected?M.value.filter(a=>!o.value.some(n=>n.value===a.value)):M.value),ue=g(()=>o.value.map(a=>a.value)),N=g(()=>{var n;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&d.value===((n=h.value[0])==null?void 0:n.title))&&h.value.length>0&&!w.value&&!S.value}),L=g(()=>e.hideNoData&&!h.value.length||e.readonly||(k==null?void 0:k.isReadonly.value)),U=$(),{onListScroll:oe,onListKeydown:se}=ta(U,m);function ie(a){B=!0,e.openOnClear&&(r.value=!0)}function re(){L.value||(r.value=!0)}function ce(a){L.value||(x.value&&(a.preventDefault(),a.stopPropagation()),r.value=!r.value)}function de(a){var c;if(ba(a)||e.readonly||k!=null&&k.isReadonly.value)return;const n=m.value.selectionStart,s=o.value.length;if((i.value>-1||["Enter","ArrowDown","ArrowUp"].includes(a.key))&&a.preventDefault(),["Enter","ArrowDown"].includes(a.key)&&(r.value=!0),["Escape"].includes(a.key)&&(r.value=!1),["Enter","Escape","Tab"].includes(a.key)&&(N.value&&["Enter","Tab"].includes(a.key)&&p(M.value[0]),w.value=!0),a.key==="ArrowDown"&&N.value&&((c=U.value)==null||c.focus("next")),!!e.multiple){if(["Backspace","Delete"].includes(a.key)){if(i.value<0){a.key==="Backspace"&&!d.value&&(i.value=s-1);return}const t=i.value,v=o.value[i.value];v&&!v.props.disabled&&p(v,!1),i.value=t>=s-1?s-2:t}if(a.key==="ArrowLeft"){if(i.value<0&&n>0)return;const t=i.value>-1?i.value-1:s-1;o.value[t]?i.value=t:(i.value=-1,m.value.setSelectionRange(d.value.length,d.value.length))}if(a.key==="ArrowRight"){if(i.value<0)return;const t=i.value+1;o.value[t]?i.value=t:(i.value=-1,m.value.setSelectionRange(0,0))}a.key==="Enter"&&d.value&&(p(J(e,d.value)),d.value="")}}function ve(){var a;x.value&&(w.value=!0,(a=m.value)==null||a.focus())}function p(a){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e.multiple){const s=o.value.findIndex(t=>e.valueComparator(t.value,a.value)),c=n??!~s;if(~s){const t=c?[...o.value,a]:[...o.value];t.splice(s,1),o.value=t}else c&&(o.value=[...o.value,a]);e.clearOnSelect&&(d.value="")}else{const s=n!==!1;o.value=s?[a]:[],V.value=s?a.title:"",Ve(()=>{r.value=!1,w.value=!0})}}function T(a){x.value=!0,setTimeout(()=>{S.value=!0})}function D(a){S.value=!1}function fe(a){(a==null||a===""&&!e.multiple)&&(o.value=[])}return G(x,(a,n)=>{a||a===n||(i.value=-1,r.value=!1,N.value&&!S.value&&!o.value.some(s=>{let{value:c}=s;return c===h.value[0].value})?p(h.value[0]):e.multiple&&d.value&&p(J(e,d.value)))}),G(r,()=>{if(!e.hideSelected&&r.value&&o.value.length){const a=h.value.findIndex(n=>o.value.some(s=>e.valueComparator(s.value,n.value)));na&&window.requestAnimationFrame(()=>{var n;a>=0&&((n=H.value)==null||n.scrollToIndex(a))})}}),G(h,(a,n)=>{x.value&&(!a.length&&e.hideNoData&&(r.value=!1),!n.length&&a.length&&(r.value=!0))}),Pe(()=>{const a=!!(e.chips||l.chip),n=!!(!e.hideNoData||h.value.length||l["prepend-item"]||l["append-item"]||l["no-data"]),s=o.value.length>0,c=pe.filterProps(e);return u(pe,I({ref:m},c,{modelValue:d.value,"onUpdate:modelValue":[t=>d.value=t,fe],focused:x.value,"onUpdate:focused":t=>x.value=t,validationValue:o.externalValue,counterValue:te.value,dirty:s,class:["v-combobox",{"v-combobox--active-menu":r.value,"v-combobox--chips":!!e.chips,"v-combobox--selection-slot":!!l.selection,"v-combobox--selecting-index":i.value>-1,[`v-combobox--${e.multiple?"multiple":"single"}`]:!0},e.class],style:e.style,readonly:e.readonly,placeholder:s?void 0:e.placeholder,"onClick:clear":ie,"onMousedown:control":re,onKeydown:de}),{...l,default:()=>u(Y,null,[u(ua,I({ref:K,modelValue:r.value,"onUpdate:modelValue":t=>r.value=t,activator:"parent",contentClass:"v-combobox__content",disabled:L.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:ve},e.menuProps),{default:()=>[n&&u(oa,I({ref:U,selected:ue.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:t=>t.preventDefault(),onKeydown:se,onFocusin:T,onFocusout:D,onScrollPassive:oe,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},e.listProps),{default:()=>{var t,v,b;return[(t=l["prepend-item"])==null?void 0:t.call(l),!h.value.length&&!e.hideNoData&&(((v=l["no-data"])==null?void 0:v.call(l))??u(we,{title:C(e.noDataText)},null)),u(sa,{ref:H,renderless:!0,items:h.value},{default:P=>{var be;let{item:f,index:R,itemRef:F}=P;const he=I(f.props,{ref:F,key:R,active:N.value&&R===0?!0:void 0,onClick:()=>p(f,null)});return((be=l.item)==null?void 0:be.call(l,{item:f,index:R,props:he}))??u(we,I(he,{role:"option"}),{prepend:q=>{let{isSelected:W}=q;return u(Y,null,[e.multiple&&!e.hideSelected?u(ia,{key:f.value,modelValue:W,ripple:!1,tabindex:"-1"},null):void 0,f.props.prependAvatar&&u(ra,{image:f.props.prependAvatar},null),f.props.prependIcon&&u(ke,{icon:f.props.prependIcon},null)])},title:()=>{var q,W;return w.value?f.title:ya(f.title,(q=ne(f))==null?void 0:q.title,((W=d.value)==null?void 0:W.length)??0)}})}}),(b=l["append-item"])==null?void 0:b.call(l)]}})]}),o.value.map((t,v)=>{function b(F){F.stopPropagation(),F.preventDefault(),p(t,!1)}const P={"onClick:close":b,onMousedown(F){F.preventDefault(),F.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},f=a?!!l.chip:!!l.selection,R=f?ca(a?l.chip({item:t,index:v,props:P}):l.selection({item:t,index:v})):void 0;if(!(f&&!R))return u("div",{key:t.value,class:["v-combobox__selection",v===i.value&&["v-combobox__selection--selected",ae.value]],style:v===i.value?le.value:{}},[a?l.chip?u(va,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:t.title}}},{default:()=>[R]}):u(da,I({key:"chip",closable:e.closableChips,size:"small",text:t.title,disabled:t.props.disabled},P),null):R??u("span",{class:"v-combobox__selection-text"},[t.title,e.multiple&&v<o.value.length-1&&u("span",{class:"v-combobox__selection-comma"},[fa(",")])])])})]),"append-inner":function(){var P;for(var t=arguments.length,v=new Array(t),b=0;b<t;b++)v[b]=arguments[b];return u(Y,null,[(P=l["append-inner"])==null?void 0:P.call(l,...v),(!e.hideNoData||e.items.length)&&e.menuIcon?u(ke,{class:"v-combobox__menu-icon",icon:e.menuIcon,onMousedown:ce,onClick:ma,"aria-label":C(j.value),title:C(j.value)},null):void 0])}})}),ha({isFocused:x,isPristine:w,menu:r,search:d,selectionIndex:i,filteredItems:M,select:p},m)}});export{ka as V,Ia as a};
